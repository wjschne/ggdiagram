<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Repetition and Automation • ggdiagram</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto_Condensed-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="automation_files/libs/quarto-html/popper.min.js"></script><script src="automation_files/libs/quarto-html/tippy.umd.min.js"></script><link href="automation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="automation_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Repetition and Automation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggdiagram</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/ggdiagram.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/angles.html">Angles</a></li>
    <li><a class="dropdown-item" href="../articles/arcwedges.html">Arcs and Wedges</a></li>
    <li><a class="dropdown-item" href="../articles/automation.html">Repetition and Automation</a></li>
    <li><a class="dropdown-item" href="../articles/bezier.html">Bézier Curves</a></li>
    <li><a class="dropdown-item" href="../articles/causalpaths.html">Path Diagrams</a></li>
    <li><a class="dropdown-item" href="../articles/circles.html">Circles</a></li>
    <li><a class="dropdown-item" href="../articles/colors.html">Colors</a></li>
    <li><a class="dropdown-item" href="../articles/ellipses.html">Ellipses</a></li>
    <li><a class="dropdown-item" href="../articles/equations.html">Equations with LaTeX</a></li>
    <li><a class="dropdown-item" href="../articles/lines.html">Lines</a></li>
    <li><a class="dropdown-item" href="../articles/paths.html">Paths</a></li>
    <li><a class="dropdown-item" href="../articles/points.html">Points</a></li>
    <li><a class="dropdown-item" href="../articles/polygons.html">Polygons</a></li>
    <li><a class="dropdown-item" href="../articles/rectangles.html">Rectangles</a></li>
    <li><a class="dropdown-item" href="../articles/segments.html">Segments</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/wjschne/ggdiagram/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Repetition and Automation</h1>




      <small class="dont-index">Source: <a href="https://github.com/wjschne/ggdiagram/blob/HEAD/vignettes/articles/automation.qmd" class="external-link"><code>vignettes/articles/automation.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="section level2"><h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wjschne/ggdiagram" class="external-link">ggdiagram</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/ggtext/" class="external-link">ggtext</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://teunbrand.github.io/ggarrow/" class="external-link">ggarrow</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="object-lists">Object Lists<a class="anchor" aria-label="anchor" href="#object-lists"></a>
</h2>
<p>Any ggdiagram object made with <code>ob_*</code> functions can be made into a list, either with the <code>list</code> function or the <code>c</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p1</span>,<span class="va">p2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── &lt;ob_point&gt;</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span><span class="co">#&gt;       x     y</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     1     2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── &lt;ob_point&gt;</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span><span class="co">#&gt;       x     y</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     3     4</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="binding-lists-of-objects-into-a-single-object">Binding lists of objects into a single object<a class="anchor" aria-label="anchor" href="#binding-lists-of-objects-into-a-single-object"></a>
</h2>
<p>The <code>bind</code> function will take a list of the ggdiagram objects and a create single object. If all objects in the list are of a single type (e.g., <code>ob_point</code>), <code>bind</code> will return an object of that type. If the objects are of multiple types, <code>bind</code> will bind each type of object separately and return a <code>ob_shape_list</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind.html">bind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p1</span>,<span class="va">p2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── &lt;ob_point&gt;</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span><span class="co">#&gt;       x     y</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     1     2</span></span>
<span><span class="co">#&gt; 2     3     4</span></span></code></pre></div>
</div>
<p>Binding objects can make subsequent tasks easier and less repetitive. For example, from the new object <code>p</code>, we can create two circles with one line of code rather than the two lines that would otherwise be needed to create separate circles from <code>p1</code> and <code>p2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span>center <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="automation_files/figure-html/circle-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<p>With only two points, the time savings is small. When many objects are bound, the time savings can be substantial.</p>
<p>If the list of objects are of different types, the <code>bind</code> function will bind all objects of the same type and the resulting list will be an <code>ob_shape_list</code>. In <a href="#fig-osl" class="quarto-xref">Figure 1</a> we bind 2 points and 2 circles into a <code>ob_shape_list</code> that has 1 <code>ob_point</code> and 1 <code>ob_circle</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">c1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span><span class="va">p1</span>, radius <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">c2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span><span class="va">p2</span>, radius <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># bind objectins into an ob_shape_list</span></span>
<span><span class="va">osl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind.html">bind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">c1</span>, <span class="va">c2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">osl</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── &lt;ob_shape_list&gt; ─────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── &lt;ob_point&gt;</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span><span class="co">#&gt;       x     y</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     0     0</span></span>
<span><span class="co">#&gt; 2     2     0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── &lt;ob_circle&gt;</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 3</span></span>
<span><span class="co">#&gt;       x     y     r</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     0     0   2  </span></span>
<span><span class="co">#&gt; 2     2     0   1.5</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">osl</span></span></code></pre></div>
<div class="cell-output-display">
<div id="fig-osl" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-osl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="automation_files/figure-html/fig-osl-1.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-osl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 1: An ob_shape_list
</figcaption></figure>
</div>
</div>
</div>
<p>There is not much benefit to making an <code>ob_shape_list</code> as shown here. It would simpler to just include the objects one at a time. However, it can be useful in the context of a large diagram with many elements, each of which would require a separate layer in ggplot2. Binding all the elements first can reduce the number of ggplot layers to the number of object types in the <code>ob_shape_list</code>.</p>
<p>An <code>ob_shape_list</code>’s underlying data is a named list. The names are the functions that were used to create the objects. For example,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">osl</span><span class="op">[[</span><span class="st">"ob_point"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── &lt;ob_point&gt;</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span><span class="co">#&gt;       x     y</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     0     0</span></span>
<span><span class="co">#&gt; 2     2     0</span></span>
<span><span class="va">osl</span><span class="op">[[</span><span class="st">"ob_circle"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── &lt;ob_circle&gt;</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 3</span></span>
<span><span class="co">#&gt;       x     y     r</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     0     0   2  </span></span>
<span><span class="co">#&gt; 2     2     0   1.5</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="use-unbind-to-make-an-object-into-a-list-of-objects">Use <code>unbind</code> to make an object into a list of objects<a class="anchor" aria-label="anchor" href="#use-unbind-to-make-an-object-into-a-list-of-objects"></a>
</h2>
<p>The <code>unbind</code> function will perform the opposite operation as <code>bind</code>. It converts the elements of an object into a list of singleton objects. For example, object <code>p</code> has two points. Unbinding it will create a list of 2 <code>ob_point</code> objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/unbind.html">unbind</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── &lt;ob_point&gt;</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span><span class="co">#&gt;       x     y</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     1     2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── &lt;ob_point&gt;</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span><span class="co">#&gt;       x     y</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     3     4</span></span></code></pre></div>
</div>
<p>The <code>unbind</code> function is needed when we want to loop through each element using <code>lapply</code> or <code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">purrr::map</a></code>. Here we have two points and we want to put six points the both. We want to connect each element of one column to each element of the other column. Note that the output of <code>lapply</code> or <code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">purrr::map</a></code> is a list. To make the list something that ggplot2 can plot, we can bind the list into a single object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">360</span>, <span class="fl">120</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="va">p_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_point.html">ob_polar</a></span><span class="op">(</span></span>
<span>        theta <span class="op">=</span> <span class="va">theta</span>,</span>
<span>        r <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>        fill <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>        shape <span class="op">=</span> <span class="st">"triangle down filled"</span>,</span>
<span>        size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unbind.html">unbind</a></span><span class="op">(</span><span class="va">p_3</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>      \<span class="op">(</span><span class="va">p_i</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">p_i</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_point.html">ob_polar</a></span><span class="op">(</span></span>
<span>          theta <span class="op">=</span> <span class="va">theta</span>, </span>
<span>          r <span class="op">=</span> <span class="fl">.15</span>, </span>
<span>          color <span class="op">=</span> <span class="st">"orchid"</span>, </span>
<span>          fill <span class="op">=</span> <span class="st">"orchid"</span>, </span>
<span>          size <span class="op">=</span> <span class="fl">15</span>, </span>
<span>          shape <span class="op">=</span> <span class="st">"triangle filled"</span><span class="op">)</span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/bind.html">bind</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span><span class="cn">NULL</span>, expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span><span class="fl">.15</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div id="fig-unbind" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-unbind-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="automation_files/figure-html/fig-unbind-1.png" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-unbind-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 2: Using <code>unbind</code>, <code>map</code>, and <code>bind</code> to loop through elements.
</figcaption></figure>
</div>
</div>
</div>
<p>Alternatively, we can convert each list item into a geom with <code>as.geom</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_point.html">ob_polar</a></span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">330</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                 r <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                 size <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                 color <span class="op">=</span> <span class="st">"orchid"</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unbind.html">unbind</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">pp</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">pp</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_point.html">ob_polar</a></span><span class="op">(</span></span>
<span>        theta <span class="op">=</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">330</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        r <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">pp</span>, <span class="va">p2</span><span class="op">)</span></span>
<span>        </span>
<span>      <span class="fu"><a href="../reference/as.geom.html">as.geom</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<div id="fig-unbindgeom" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-unbindgeom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="automation_files/figure-html/fig-unbindgeom-1.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-unbindgeom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 3: Using <code>unbind</code>, <code>lapply</code>, and <code>as.geom</code> to loop through elements.
</figcaption></figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="use-map_ob-to-loop-through-object-elements">Use <code>map_ob</code> to loop through object elements<a class="anchor" aria-label="anchor" href="#use-map_ob-to-loop-through-object-elements"></a>
</h2>
<p>To <code>unbind</code>, <code>map</code>, and then <code>bind</code> can be tedious every time a loop is needed. The <code>map_ob</code> function is a wrapper for <code>map</code> that unbinds the input and binds the output automatically.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_point.html">ob_polar</a></span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span>, <span class="fl">180</span>, <span class="fl">270</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">o</span>, <span class="va">p</span>, resect <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">p</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/map_ob.html">map_ob</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">pp</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">pp</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_point.html">ob_polar</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">45</span>, <span class="fl">315</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">3</span>,</span>
<span>                          color <span class="op">=</span> <span class="st">"orchid"</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">p2</span>,</span>
<span>           <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">pp</span>, <span class="va">p2</span>, resect <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<div id="fig-obmap" class="quarto-float quarto-figure quarto-figure-center" width="672">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-obmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="automation_files/figure-html/fig-obmap-1.png" id="fig-obmap" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-obmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 4
</figcaption></figure>
</div>
</div>
</div>
<p>The <code>ob_map</code> function can output a list of different object types simultaneously.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">300</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">e6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_ellipse.html">ob_ellipse</a></span><span class="op">(</span></span>
<span>    center <span class="op">=</span> <span class="fu"><a href="../reference/ob_point.html">ob_polar</a></span><span class="op">(</span></span>
<span>      theta <span class="op">=</span> <span class="va">theta</span>, </span>
<span>      r <span class="op">=</span> <span class="fl">60</span><span class="op">)</span>,</span>
<span>    m1 <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>    a <span class="op">=</span> <span class="fl">8</span>,</span>
<span>    b <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    angle <span class="op">=</span> <span class="va">theta</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"orchid4"</span>, </span>
<span>    size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/map_ob.html">map_ob</a></span><span class="op">(</span><span class="va">e6</span>, \<span class="op">(</span><span class="va">e_i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p_i</span> <span class="op">&lt;-</span> <span class="va">e_i</span><span class="op">@</span><span class="va">center</span></span>
<span>    <span class="va">p_ij</span> <span class="op">&lt;-</span> <span class="va">p_i</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_point.html">ob_polar</a></span><span class="op">(</span><span class="va">theta</span>, <span class="fl">15</span><span class="op">)</span></span>
<span>    <span class="va">c_ij</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span></span>
<span>      center <span class="op">=</span> <span class="va">p_ij</span>, </span>
<span>      radius <span class="op">=</span> <span class="fl">2</span>,</span>
<span>      fill <span class="op">=</span> <span class="st">"green4"</span>,</span>
<span>      color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span>    <span class="va">p_ijk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_ob.html">map_ob</a></span><span class="op">(</span><span class="va">p_ij</span>, \<span class="op">(</span><span class="va">pt_ij</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="../reference/ob_segment.html">ob_segment</a></span><span class="op">(</span><span class="va">pt_ij</span>, <span class="va">pt_ij</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_point.html">ob_polar</a></span><span class="op">(</span><span class="va">theta</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">p_ijk</span>, <span class="va">c_ij</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div id="fig-map" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="automation_files/figure-html/fig-map-1.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 5: Outputting a list of different object types in <code>map_ob</code>.
</figcaption></figure>
</div>
</div>
</div>
<p>In a more practical example, every variable in the left column is connected to every variable on the right.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">clr</span> <span class="op">&lt;-</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="va">k</span>, begin <span class="op">=</span> <span class="fl">.3</span>, end <span class="op">=</span> <span class="fl">.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_array.html">ob_array</a></span><span class="op">(</span><span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span><span class="op">)</span>, k <span class="op">=</span> <span class="va">k</span>, where <span class="op">=</span> <span class="st">"north"</span>, </span>
<span>                  fill <span class="op">=</span> <span class="va">clr</span>,</span>
<span>                  color <span class="op">=</span> <span class="va">clr</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">clr</span>, color <span class="op">=</span> <span class="va">clr</span><span class="op">)</span><span class="op">@</span><span class="va">place</span><span class="op">(</span></span>
<span>    from <span class="op">=</span> <span class="va">t1</span>, </span>
<span>    where <span class="op">=</span> <span class="st">"right"</span>, </span>
<span>    sep <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/map_ob.html">map_ob</a></span><span class="op">(</span><span class="va">t1</span>, \<span class="op">(</span><span class="va">tt</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">tt</span>, <span class="va">t2</span>, resect <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="va">tt</span><span class="op">@</span><span class="va">color</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div id="fig-bindt1t2" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-bindt1t2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="automation_files/figure-html/fig-bindt1t2-1.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bindt1t2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 6: Using <code>map_ob</code> to the connect variables
</figcaption></figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="subsetting-objects">Subsetting objects<a class="anchor" aria-label="anchor" href="#subsetting-objects"></a>
</h2>
<p>The <code>[</code> operator can subset ggdiagram objects created with <code>ob_*</code> functions. Object <code>p</code> has 2 points in it. To select the first point only:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── &lt;ob_point&gt;</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span><span class="co">#&gt;       x     y</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     1     0</span></span></code></pre></div>
</div>
<p>The strategic use of subsetting can make otherwise repetitive tasks much less tedious. In <a href="#fig-c12" class="quarto-xref">Figure 7</a> we connect a ring of 12 circles with one command rather than 12.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">330</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">clr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/hsv.html" class="external-link">hsv</a></span><span class="op">(</span><span class="va">theta</span><span class="op">@</span><span class="va">degree</span> <span class="op">/</span> <span class="fl">360</span>, s <span class="op">=</span> <span class="fl">.4</span>, v <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">c12</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span></span>
<span>    center <span class="op">=</span> <span class="fu"><a href="../reference/ob_point.html">ob_polar</a></span><span class="op">(</span><span class="va">theta</span>, r <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clr</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">c12</span>, <span class="va">c12</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">1</span><span class="op">)</span><span class="op">]</span>, </span>
<span>          resect <span class="op">=</span> <span class="fl">2</span>, </span>
<span>          color <span class="op">=</span> <span class="va">clr</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<div id="fig-c12" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-c12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="automation_files/figure-html/fig-c12-1.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-c12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 7: A ring of connected circles.
</figcaption></figure>
</div>
</div>
</div>
<p>Subsetting can be used for assignment in ggdiagram objects. For example, in <a href="#fig-subsetting" class="quarto-xref">Figure 8</a>, the first of four points is changed from (1,5) to (0,0)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, </span>
<span>              y <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">p</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>, color <span class="op">=</span> <span class="st">"firebrick"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">p</span> </span></code></pre></div>
<div class="cell-output-display">
<div id="fig-subsetting" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-subsetting-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="automation_files/figure-html/fig-subsetting-1.png" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-subsetting-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 8: Subsetting objects
</figcaption></figure>
</div>
</div>
</div>
<p>In <a href="#fig-path" class="quarto-xref">Figure 9</a>, there are 8 variables with 13 arrows connecting them. Rather than making a separate connection for each arrow, subsetting allows us to make all 13 connections with a single <code>connect</code> command. Using subsetting to assign variables within a <code>for</code> loop allows for placing the variables programmatically. If more or fewer variables are desired, setting <code>k</code> to another value, will create <em>k</em> variables and 2<em>k</em> − 3 connections.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number of variables</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">8L</span></span>
<span></span>
<span><span class="co"># Make k variables</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_rectangle.html">ob_rectangle</a></span><span class="op">(</span><span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">k</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">k</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>                    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"*X*~"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">k</span>, <span class="st">"~"</span><span class="op">)</span>,</span>
<span>                    vjust <span class="op">=</span> <span class="fl">.6</span>,</span>
<span>                    size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                    family <span class="op">=</span> <span class="st">"Roboto Condensed"</span></span>
<span>                  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># Place even variables to the right and </span></span>
<span><span class="co"># odd variables below the previous variables</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">k</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">(</span><span class="va">i</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">2</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span>, <span class="st">"right"</span>, <span class="st">"below"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">x</span> <span class="op">+</span></span>
<span>  <span class="co"># paths between variables ahead by 1 and by 2</span></span>
<span>  <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">k</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">k</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, </span>
<span>          <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="va">k</span><span class="op">)</span>,     <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="va">k</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>,</span>
<span>          resect <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div id="fig-path" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-path-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="automation_files/figure-html/fig-path-1.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-path-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 9: A model with 8 variables and 13 causal paths
</figcaption></figure>
</div>
</div>
</div>
<section class="level2"><h3 id="subset-by-id">Subset by id<a class="anchor" aria-label="anchor" href="#subset-by-id"></a>
</h3>
<p>Functions with an <code>ob_*</code> prefix have an <code>id</code> property that can be used to subset objects. The <code>id</code> property does not have to be unique.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">6</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"A"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── &lt;ob_point&gt;</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 3</span></span>
<span><span class="co">#&gt;       x     y id   </span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1     2     5 B    </span></span>
<span><span class="co">#&gt; 2     1     4 A</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="creating-objects-from-data-framestibbles">Creating objects from data.frames/tibbles<a class="anchor" aria-label="anchor" href="#creating-objects-from-data-framestibbles"></a>
</h3>
<p>The <code>data2shape</code> function will convert a data.frame (or tibble) to a ggdiagram <code>ob_...</code> function. For example, <a href="#fig-data2shape" class="quarto-xref">Figure 10</a>, a sequence of regular polygons was quickly and efficiently.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  y <span class="op">=</span> <span class="va">x</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">x</span> <span class="op">*</span> <span class="fl">.1</span>,</span>
<span>  radius <span class="op">=</span> <span class="fl">.6</span>,</span>
<span>  angle <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  fill <span class="op">=</span> <span class="st">"dodgerblue4"</span>,</span>
<span>  n <span class="op">=</span> <span class="va">x</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/data2shape.html">data2shape</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d</span>, shape <span class="op">=</span> <span class="va">ob_ngon</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div id="fig-data2shape" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-data2shape-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="automation_files/figure-html/fig-data2shape-1.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-data2shape-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 10: A sequence of regular polygons
</figcaption></figure>
</div>
</div>
</div>
<p>Although <code>data2shape</code> is sometimes less verbose than standard ggplot2 syntax, using it is not always the best choice. If you start with a data.frame (or tibble), and all you need to do is display data, the standard ggplot2 functions are optimized for this purpose, particularly when the data set is large. In general, the direct use of a ggplot2 function will render more quickly than its analogous ggdiagram function. The reason to convert data to shapes via <code>data2shape</code> is to do something that would be otherwise difficult with the standard ggplot2 functions.</p>
<p>For example, one of the problems that prompted me to make the ggdiagram package was that I wanted to make path diagrams for structural equation models with full control of every aspect of the diagram. There are excellent functions from other packages that automate the process of making a path diagram (e.g., <a href="https://cran.r-project.org/package=semPlot" class="external-link"><code>semPlot</code></a>, <a href="https://sfcheung.github.io/semptools/index.html" class="external-link">semptools</a>, and <a href="https://lavaanplot.alexlishinski.com/" class="external-link"><code>lavaanPlot</code></a>), with options for greater flexibility. Even so, I could not figure out how to make the plots fully customizable.</p>
<p>My eventual goal is for ggdiagram to automate the tedious parts of making path diagrams and allow for efficient customization. The code for <a href="#fig-lavaan" class="quarto-xref">Figure 11</a> shows the whole process, including the tedious bits that eventually will be tucked way in functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; This is lavaan 0.6-19</span></span>
<span><span class="co">#&gt; lavaan is FREE software! Please report any bugs.</span></span>
<span></span>
<span><span class="co"># Observed variable name conversion</span></span>
<span><span class="va">onames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>VisualPerception <span class="op">=</span> <span class="st">"x1"</span>,</span>
<span>               Cubes <span class="op">=</span> <span class="st">"x2"</span>,</span>
<span>               Lozenges <span class="op">=</span> <span class="st">"x3"</span>,</span>
<span>               CapitalsSpeed <span class="op">=</span> <span class="st">"x9"</span>,</span>
<span>               AdditionSpeed <span class="op">=</span> <span class="st">"x7"</span>,</span>
<span>               CountingSpeed <span class="op">=</span> <span class="st">"x8"</span>,</span>
<span>               ParagraphComp <span class="op">=</span> <span class="st">"x4"</span>,</span>
<span>               SentenceComp <span class="op">=</span> <span class="st">"x5"</span>,</span>
<span>               WordMeaning <span class="op">=</span> <span class="st">"x6"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/lavaan/man/HolzingerSwineford1939.html" class="external-link">HolzingerSwineford1939</a></span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">x1</span><span class="op">:</span><span class="va">x9</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">onames</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Structural Model</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">Gv =~ VisualPerception + Cubes + Lozenges + CapitalsSpeed</span></span>
<span><span class="st">Gs =~ CapitalsSpeed + CountingSpeed + AdditionSpeed </span></span>
<span><span class="st">Gc =~ ParagraphComp + SentenceComp + WordMeaning</span></span>
<span><span class="st">g =~ Gv + Gc + Gs</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="co"># Fit model with converted names</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="va">m</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parameter table, find primary indicators</span></span>
<span><span class="va">pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/standardizedSolution.html" class="external-link">standardizedsolution</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>primary_indicator <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">dense_rank</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">est.std</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">op</span> <span class="op">==</span> <span class="st">"=~"</span>, </span>
<span>    .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rhs</span>, <span class="va">op</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Oberved and latent names</span></span>
<span><span class="va">o_names</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavNames.html" class="external-link">lavNames</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"ov"</span><span class="op">)</span></span>
<span><span class="va">l_names</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavNames.html" class="external-link">lavNames</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"lv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make colors</span></span>
<span><span class="va">latent_colors</span> <span class="op">&lt;-</span> <span class="va">l_names</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span>, begin <span class="op">=</span> <span class="fl">.2</span>, end <span class="op">=</span> <span class="fl">.75</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">`names&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">l_names</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make data for creating objects</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">o_names</span>, <span class="va">l_names</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>depth <span class="op">=</span> <span class="fu"><a href="../reference/get_depth.html">get_depth</a></span><span class="op">(</span><span class="va">id</span>, model <span class="op">=</span> <span class="va">m</span><span class="op">)</span>,</span>
<span>         type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">l_names</span>, <span class="st">"latent"</span>, <span class="st">"observed"</span><span class="op">)</span>,</span>
<span>         m1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"latent"</span>, <span class="fl">2</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>         a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"latent"</span>, <span class="fl">2</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>         color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>         indicators <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">id</span>, \<span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">{</span></span>
<span>           <span class="va">pt</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">op</span> <span class="op">==</span> <span class="st">"=~"</span> <span class="op">&amp;</span> <span class="va">lhs</span> <span class="op">==</span> <span class="va">v</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>indicator <span class="op">=</span> <span class="va">rhs</span>,</span>
<span>                    loading <span class="op">=</span> <span class="va">est.std</span>,</span>
<span>                    <span class="va">primary_indicator</span><span class="op">)</span></span>
<span>         <span class="op">}</span><span class="op">)</span>,</span>
<span>         dvs <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">id</span>, \<span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">{</span></span>
<span>           <span class="va">pt</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">op</span> <span class="op">==</span> <span class="st">"~"</span> <span class="op">&amp;</span> <span class="va">rhs</span> <span class="op">==</span> <span class="va">v</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>dv <span class="op">=</span> <span class="va">rhs</span>,</span>
<span>                    b <span class="op">=</span> <span class="va">est.std</span><span class="op">)</span></span>
<span>         <span class="op">}</span><span class="op">)</span>,</span>
<span>         parents <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">id</span>, \<span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">{</span> </span>
<span>           <span class="va">pt</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">op</span> <span class="op">==</span> <span class="st">"=~"</span> <span class="op">&amp;</span> <span class="va">rhs</span> <span class="op">==</span> <span class="va">v</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">est.std</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">lhs</span><span class="op">)</span></span>
<span>         <span class="op">}</span><span class="op">)</span>,</span>
<span>         fill <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap_chr</a></span><span class="op">(</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>i <span class="op">=</span> <span class="va">id</span>, </span>
<span>                tp <span class="op">=</span> <span class="va">type</span>, </span>
<span>                prnts <span class="op">=</span> <span class="va">parents</span><span class="op">)</span>, </span>
<span>           <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">tp</span>, <span class="va">prnts</span><span class="op">)</span> <span class="op">{</span></span>
<span>             <span class="kw">if</span> <span class="op">(</span><span class="va">tp</span> <span class="op">==</span> <span class="st">"latent"</span><span class="op">)</span> <span class="op">{</span></span>
<span>               <span class="va">fll</span> <span class="op">&lt;-</span> <span class="va">latent_colors</span><span class="op">[</span><span class="va">i</span> <span class="op">]</span></span>
<span>             <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>               <span class="va">fll</span> <span class="op">&lt;-</span> <span class="va">latent_colors</span><span class="op">[</span><span class="va">prnts</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>               </span>
<span>             <span class="op">}</span></span>
<span>             <span class="va">fll</span></span>
<span>           <span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    label <span class="op">=</span> <span class="fu">snakecase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/snakecase/man/caseconverter.html" class="external-link">to_title_case</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html" class="external-link">str_wrap</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                        whitespace_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace_all</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"\\n"</span>, <span class="st">"&lt;br&gt;"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">depth</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Make shapes</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data2shape.html">data2shape</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">ob_ellipse</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Format shape labels</span></span>
<span><span class="va">s</span><span class="op">@</span><span class="va">label</span><span class="op">@</span><span class="va">size</span><span class="op">[</span><span class="va">d</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"latent"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">s</span><span class="op">@</span><span class="va">label</span><span class="op">@</span><span class="va">nudge_y</span><span class="op">[</span><span class="va">d</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"latent"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.08</span></span>
<span><span class="va">s</span><span class="op">@</span><span class="va">label</span><span class="op">@</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/class_color.html">class_color</a></span><span class="op">(</span><span class="va">s</span><span class="op">@</span><span class="va">fill</span><span class="op">)</span><span class="op">@</span><span class="va">darken</span><span class="op">(</span><span class="fl">.6</span><span class="op">)</span><span class="op">@</span><span class="va">color</span></span>
<span></span>
<span><span class="co"># Position shapes:</span></span>
<span><span class="co">#   Move indicators to the right of other indicators</span></span>
<span><span class="co">#   Center latent variables above their primary indicators</span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">walk</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">id</span>, \<span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dr</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="va">v</span><span class="op">)</span> </span>
<span>  </span>
<span>  <span class="va">children</span> <span class="op">&lt;-</span> <span class="va">dr</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">indicators</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">primary_indicator</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">indicator</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">dr</span>, <span class="va">depth</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">s</span><span class="op">[</span><span class="va">v</span><span class="op">]</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">s</span><span class="op">[</span><span class="va">v</span><span class="op">]</span>, </span>
<span>                   <span class="va">s</span><span class="op">@</span><span class="va">bounding_box</span>, </span>
<span>                   <span class="st">"right"</span>, </span>
<span>                   sep <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">s</span><span class="op">[</span><span class="va">v</span><span class="op">]</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">s</span><span class="op">[</span><span class="va">v</span><span class="op">]</span>, </span>
<span>                   <span class="va">s</span><span class="op">[</span><span class="va">children</span><span class="op">]</span><span class="op">@</span><span class="va">bounding_box</span><span class="op">@</span><span class="va">north</span>, </span>
<span>                   <span class="st">"above"</span>, </span>
<span>                   sep <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make edges</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">indicators</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">indicator</span>, <span class="va">loading</span>, <span class="va">fill</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">nest</a></span><span class="op">(</span>.by <span class="op">=</span> <span class="va">id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">id</span>, <span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>    <span class="va">children</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">indicator</span><span class="op">)</span></span>
<span>    <span class="va">ll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">loading</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="../reference/round_probability.html">round_probability</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">s</span><span class="op">[</span><span class="va">id</span><span class="op">]</span>, </span>
<span>            to <span class="op">=</span> <span class="va">s</span><span class="op">[</span><span class="va">children</span><span class="op">]</span>, </span>
<span>            <span class="co"># to_offset = ob_point(0,4),</span></span>
<span>            label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="va">ll</span>, angle <span class="op">=</span> <span class="fl">0</span>, position <span class="op">=</span> <span class="fl">.48</span><span class="op">)</span>, </span>
<span>            label_sloped <span class="op">=</span> <span class="cn">F</span>,</span>
<span>            resect <span class="op">=</span> <span class="fl">1</span>, </span>
<span>            color <span class="op">=</span> <span class="fu"><a href="../reference/class_color.html">class_color</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">fill</span><span class="op">)</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span></span>
<span>            <span class="op">)</span><span class="op">@</span><span class="va">set_label_y</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/bind.html">bind</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make plot</span></span>
<span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span>font_family <span class="op">=</span> <span class="va">my_font</span>, </span>
<span>          font_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">s</span> <span class="op">+</span> </span>
<span>  <span class="va">e</span></span></code></pre></div>
<div class="cell-output-display">
<div id="fig-lavaan" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-lavaan-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="automation_files/figure-html/fig-lavaan-1.png" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lavaan-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 11: A latent variable model
</figcaption></figure>
</div>
</div>
</div>
</section></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by W. Joel Schneider.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
