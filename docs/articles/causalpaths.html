<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Path Diagrams • ggdiagram</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto_Condensed-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="causalpaths_files/libs/quarto-html/popper.min.js"></script><script src="causalpaths_files/libs/quarto-html/tippy.umd.min.js"></script><link href="causalpaths_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="causalpaths_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Path Diagrams">
<meta property="og:image" content="https://wjschne.github.io/ggdiagram/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggdiagram</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/ggdiagram.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/angles.html">Angles</a></li>
    <li><a class="dropdown-item" href="../articles/arcwedges.html">Arcs and Wedges</a></li>
    <li><a class="dropdown-item" href="../articles/automation.html">Repetition and Automation</a></li>
    <li><a class="dropdown-item" href="../articles/bezier.html">Bézier Curves</a></li>
    <li><a class="dropdown-item" href="../articles/causalpaths.html">Path Diagrams</a></li>
    <li><a class="dropdown-item" href="../articles/circles.html">Circles</a></li>
    <li><a class="dropdown-item" href="../articles/colors.html">Colors</a></li>
    <li><a class="dropdown-item" href="../articles/ellipses.html">Ellipses</a></li>
    <li><a class="dropdown-item" href="../articles/equations.html">Equations with LaTeX</a></li>
    <li><a class="dropdown-item" href="../articles/lines.html">Lines</a></li>
    <li><a class="dropdown-item" href="../articles/paths.html">Paths</a></li>
    <li><a class="dropdown-item" href="../articles/points.html">Points</a></li>
    <li><a class="dropdown-item" href="../articles/polygons.html">Polygons</a></li>
    <li><a class="dropdown-item" href="../articles/rectangles.html">Rectangles</a></li>
    <li><a class="dropdown-item" href="../articles/segments.html">Segments</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/wjschne/ggdiagram/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Path Diagrams</h1>




      <small class="dont-index">Source: <a href="https://github.com/wjschne/ggdiagram/blob/HEAD/vignettes/articles/causalpaths.qmd" class="external-link"><code>vignettes/articles/causalpaths.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="section level2"><h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wjschne/ggdiagram" class="external-link">ggdiagram</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://teunbrand.github.io/ggarrow/" class="external-link">ggarrow</a></span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="path-diagrams">Path diagrams<a class="anchor" aria-label="anchor" href="#path-diagrams"></a>
</h2>
<p>Structural equation models are often displayed with path diagrams. The visual vocabulary of path diagrams is fairly simple. As seen in <a href="#fig-objecttypes" class="quarto-xref">Figure 1</a>, an observed variable is a square or rectangle, and a latent variable is a circle or ellipse. Often omitted for clarity, means and intercepts are constants that can be depicted with triangles.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span>font_family <span class="op">=</span> <span class="va">my_font</span>, font_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">lv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Latent&lt;br&gt;Variable"</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_rectangle.html">ob_rectangle</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pi</span><span class="op">)</span>,</span>
<span>                  height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pi</span><span class="op">)</span>,</span>
<span>                  label <span class="op">=</span> <span class="st">"Observed&lt;br&gt;Variable"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">lv</span>, <span class="st">"right"</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, </span>
<span>               radius <span class="op">=</span> <span class="fl">1.25</span>, </span>
<span>               label <span class="op">=</span> <span class="st">"Mean/&lt;br&gt;Intercept"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">r</span>, <span class="st">"right"</span>, <span class="fl">.3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">.25</span><span class="op">)</span><span class="op">}</span> </span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-objecttypes" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-objecttypes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causalpaths_files/figure-html/fig-objecttypes-1.svg" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-objecttypes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 1: Elements of a path diagram
</figcaption></figure>
</div>
</div>
</div>
<p>In <a href="#fig-pathtype" class="quarto-xref">Figure 2</a>, two types of relationships are depicted. A single-headed arrow indicates a direct causal influence. A curved double-headed arrow indicates a correlation between two variables but does not specify the causal nature of the relationship.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span>font_family <span class="op">=</span> <span class="va">my_font</span>, font_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">this</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"This"</span>, size <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">that</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"That"</span>, size <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">this</span>, <span class="st">"right"</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">this</span>, <span class="va">that</span>, label <span class="op">=</span> <span class="st">"Causes"</span>, resect <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">this</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">this</span>, <span class="st">"below"</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">B</span> <span class="op">&lt;-</span> <span class="va">that</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">that</span>, <span class="st">"below"</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_covariance.html">ob_covariance</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span>, label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"Correlates with"</span>, vjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, arrowhead_length <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> </span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-pathtype" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-pathtype-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causalpaths_files/figure-html/fig-pathtype-1.svg" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pathtype-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 2: Relationships in a path diagram
</figcaption></figure>
</div>
</div>
</div>
<section class="level2"><h3 id="path-models-for-regression">Path Models for Regression<a class="anchor" aria-label="anchor" href="#path-models-for-regression"></a>
</h3>
<p>A regression model can be stated very simply: <em>X</em> predicts <em>Y</em>. Most of the time, this relationship can be stated with a simplified path diagram like <a href="#fig-simpleregression" class="quarto-xref">Figure 3</a>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">observed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span></span>
<span>  <span class="va">ob_ellipse</span>, </span>
<span>  m1 <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">lb_observed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span></span>
<span>  <span class="va">ob_label</span>, </span>
<span>  size <span class="op">=</span> <span class="fl">48</span>, </span>
<span>  nudge_y <span class="op">=</span> <span class="op">-</span><span class="fl">.15</span>, </span>
<span>  fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">direct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span></span>
<span>  <span class="va">connect</span>, </span>
<span>  resect <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">lb_direct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span></span>
<span>  <span class="va">ob_label</span>, </span>
<span>  angle <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  position <span class="op">=</span> <span class="fl">.47</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span>font_family <span class="op">=</span> <span class="va">my_font</span>, font_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">observed</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">lb_observed</span><span class="op">(</span><span class="st">"X"</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu">observed</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">lb_observed</span><span class="op">(</span><span class="st">"Y"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">X</span>,where <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu">direct</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-simpleregression" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-simpleregression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causalpaths_files/figure-html/fig-simpleregression-1.svg" width="240">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simpleregression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 3: Simplified path diagram of a regression model
</figcaption></figure>
</div>
</div>
</div>
<p>This simple statement skips a large number of details, which can be filled in. The predictor, <em>X</em> is a random variable with an unknown distribution <em>F<sub>X</sub></em>. It has a mean of <em>μ<sub>X</sub></em> and a standard deviation of <em>σ<sub>X</sub></em>.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>∼</mo><msub><mi>F</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>;</mo><msub><mi>μ</mi><mi>X</mi></msub><mo>,</mo><msubsup><mi>σ</mi><mi>X</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X\sim F_X(x; \mu_X,\sigma^2_X)</annotation></semantics></math></p>
<p>Regression takes <em>X</em> and subjects it to a linear transformation to create the variable <em>Ŷ</em>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>Y</mi><mo accent="true">̂</mo></mover><mo>=</mo><msub><mi>b</mi><mn>0</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mi>X</mi></mrow><annotation encoding="application/x-tex">\hat{Y}=b_0+b_1X</annotation></semantics></math> The regression coefficients <em>b<sub>0</sub></em> and <em>b<sub>1</sub></em> are known as the <em>intercept</em> and <em>slope</em>, respectively. <em>Ŷ</em> is the predicted value of <em>Y</em>, given <em>X</em>.</p>
<p>The prediction error <em>e</em> is the difference between the actual value of <em>Y</em> and its predicted value <em>Ŷ</em>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mi>Y</mi><mo>−</mo><mover><mi>Y</mi><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">e=Y-\hat{Y}</annotation></semantics></math></p>
<p>The prediction error is assumed to be normally distributed with a standard deviation of <em>σ<sub>e</sub></em>, which is known as the <em>standard error of the estimate</em>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>∼</mo><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mi>e</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">e\sim \mathcal{N}(0,\sigma^2_e)</annotation></semantics></math> Putting it all together:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><munder><munder><mrow><msub><mi>b</mi><mn>0</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mi>X</mi></mrow><mo accent="true">⏟</mo></munder><mover><mi>Y</mi><mo accent="true">̂</mo></mover></munder><mo>+</mo><mi>e</mi></mrow><annotation encoding="application/x-tex">Y=\underbrace{b_0+b_1X}_{\hat{Y}}+e</annotation></semantics></math></p>
<p>All of this can be communicated succinctly with the path diagram in <a href="#fig-fullregression" class="quarto-xref">Figure 4</a>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ln_color</span> <span class="op">&lt;-</span> <span class="st">"gray40"</span></span>
<span><span class="va">lb_color</span> <span class="op">&lt;-</span> <span class="st">"gray20"</span></span>
<span></span>
<span><span class="co"># Observed variable, label, and variance</span></span>
<span><span class="va">observed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_ellipse</span>,</span>
<span>                      a <span class="op">=</span> <span class="fl">.6</span>,</span>
<span>                      m1 <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                      color <span class="op">=</span> <span class="va">ln_color</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lb_observed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_label</span>,</span>
<span>                         size <span class="op">=</span> <span class="fl">40</span>,</span>
<span>                         nudge_y <span class="op">=</span> <span class="op">-</span><span class="fl">.07</span>,</span>
<span>                         color <span class="op">=</span> <span class="va">lb_color</span><span class="op">)</span></span>
<span></span>
<span><span class="va">var_observed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_variance</span>,</span>
<span>                          bend <span class="op">=</span> <span class="op">-</span><span class="fl">25</span>, </span>
<span>                          looseness <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>                          color <span class="op">=</span> <span class="va">ln_color</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># Error variable, label, and variance</span></span>
<span></span>
<span><span class="va">error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_circle</span>, color <span class="op">=</span> <span class="va">ln_color</span>, radius <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">lb_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_label</span>, </span>
<span>                      size <span class="op">=</span> <span class="fl">18</span>, </span>
<span>                      color <span class="op">=</span> <span class="va">lb_color</span><span class="op">)</span></span>
<span></span>
<span><span class="va">var_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_variance</span>, </span>
<span>                       looseness <span class="op">=</span> <span class="fl">1.8</span>,</span>
<span>                       theta <span class="op">=</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">60</span><span class="op">)</span>,</span>
<span>                       where <span class="op">=</span> <span class="st">"east"</span>,</span>
<span>                       color <span class="op">=</span> <span class="va">ln_color</span><span class="op">)</span></span>
<span></span>
<span><span class="va">covariance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span></span>
<span>  <span class="va">ob_covariance</span>,</span>
<span>  color <span class="op">=</span> <span class="va">ln_color</span>,</span>
<span>  bend <span class="op">=</span> <span class="fl">45</span>,</span>
<span>  linewidth <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>  arrowhead_length <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  looseness <span class="op">=</span> <span class="fl">1.2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Direct Effect and label</span></span>
<span><span class="va">direct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">connect</span>, resect <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="va">ln_color</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lb_direct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span></span>
<span>  <span class="va">ob_label</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  color <span class="op">=</span> <span class="va">lb_color</span>,</span>
<span>  angle <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  vjust <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>  position <span class="op">=</span> <span class="fl">.46</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span>font_family <span class="op">=</span> <span class="va">my_font</span>, font_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Predictor Variable</span></span>
<span>  <span class="op">{</span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">observed</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">lb_observed</span><span class="op">(</span><span class="st">"*X*"</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="co"># Predicted Value</span></span>
<span>  <span class="op">{</span><span class="va">Yhat</span> <span class="op">&lt;-</span> <span class="fu">observed</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">lb_observed</span><span class="op">(</span><span class="st">"*Ŷ*"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">X</span>, <span class="st">"right"</span>, sep <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="co"># Outcome Variable</span></span>
<span>  <span class="op">{</span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu">observed</span><span class="op">(</span></span>
<span>    label <span class="op">=</span> <span class="fu">lb_observed</span><span class="op">(</span><span class="st">"*Y*"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">Yhat</span>, <span class="st">"right"</span>, sep <span class="op">=</span> <span class="fl">.75</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="co"># Error</span></span>
<span>  <span class="op">{</span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu">error</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">lb_observed</span><span class="op">(</span><span class="st">"*e*"</span>, nudge_y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">Y</span>, <span class="st">"right"</span>, sep <span class="op">=</span> <span class="fl">.75</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="co"># Error Variances and labels</span></span>
<span>  <span class="op">{</span><span class="va">sigma_x</span> <span class="op">&lt;-</span> <span class="fu">var_observed</span><span class="op">(</span><span class="va">X</span>, where <span class="op">=</span> <span class="st">"west"</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">sigma_e</span> <span class="op">&lt;-</span> <span class="fu">var_error</span><span class="op">(</span><span class="va">e</span>, where <span class="op">=</span> <span class="st">"east"</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_latex.html">ob_latex</a></span><span class="op">(</span>tex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">r"(\text{\emph{σ}}^{\text{2}}_{\mkern-1.5mu\text{\emph{X}}})"</span>, </span>
<span>    <span class="st">r"(\text{\emph{σ}}^{\text{2}}_{\mkern-1.5mu\text{\emph{e}}})"</span><span class="op">)</span>, </span>
<span>    color <span class="op">=</span> <span class="va">lb_color</span>,</span>
<span>    center <span class="op">=</span> <span class="fu"><a href="../reference/bind.html">bind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sigma_x</span>, <span class="va">sigma_e</span><span class="op">)</span><span class="op">)</span><span class="op">@</span><span class="va">midpoint</span><span class="op">(</span><span class="op">)</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">.4</span>, </span>
<span>    family <span class="op">=</span> <span class="va">my_font</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Mean / Intercept</span></span>
<span>  <span class="op">{</span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_intercept.html">ob_intercept</a></span><span class="op">(</span></span>
<span>    center <span class="op">=</span> <span class="fu"><a href="../reference/ob_point.html">ob_polar</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">60</span><span class="op">)</span>, </span>
<span>                      <span class="fu"><a href="../reference/distance.html">distance</a></span><span class="op">(</span><span class="va">X</span><span class="op">@</span><span class="va">center</span>,<span class="va">Yhat</span><span class="op">@</span><span class="va">center</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">-</span><span class="fl">.2</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>    radius <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"pt"</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>    linewidth <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>    color <span class="op">=</span> <span class="va">ln_color</span>, </span>
<span>    label <span class="op">=</span> <span class="fu">lb_observed</span><span class="op">(</span><span class="fl">1</span>, size <span class="op">=</span> <span class="fl">30</span>, nudge_y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="co"># Direct paths</span></span>
<span>  <span class="fu">direct</span><span class="op">(</span><span class="va">X</span>, <span class="va">Yhat</span>, label <span class="op">=</span> <span class="fu">lb_direct</span><span class="op">(</span><span class="st">"*b*~1~"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">direct</span><span class="op">(</span><span class="va">i</span>, <span class="va">X</span>,  label <span class="op">=</span> <span class="fu">lb_direct</span><span class="op">(</span><span class="st">"*&amp;mu;~X~*"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">direct</span><span class="op">(</span><span class="va">i</span>, <span class="va">Yhat</span>, label <span class="op">=</span> <span class="fu">lb_direct</span><span class="op">(</span><span class="st">"*b*~0~"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">direct</span><span class="op">(</span><span class="va">Yhat</span>,<span class="va">Y</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">direct</span><span class="op">(</span><span class="va">e</span>, <span class="va">Y</span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-fullregression" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-fullregression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causalpaths_files/figure-html/fig-fullregression-1.svg" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fullregression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 4: Full path diagram of a regression model
</figcaption></figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="path-diagrams-for-path-analysis">Path Diagrams for Path Analysis<a class="anchor" aria-label="anchor" href="#path-diagrams-for-path-analysis"></a>
</h3>
<p>Path diagrams were created by Sewall Wright <span class="citation" data-cites="wrightRelativeImportanceHeredity1920">(<a href="#ref-wrightRelativeImportanceHeredity1920" role="doc-biblioref">1920</a>)</span> to display path analyses—interconnected regression models with sequences of direct and indirect relationships among variables.</p>
<p>For example, these two regression equations combined make up a causal system that shows how variables <em>X</em><sub>1</sub>–<em>X</em><sub>4</sub> interrelate.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>X</mi><mn>3</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>b</mi><mn>13</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>23</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mo>+</mo><msub><mi>e</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>X</mi><mn>4</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>b</mi><mn>14</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>24</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mo>+</mo><msub><mi>b</mi><mn>34</mn></msub><msub><mi>X</mi><mn>3</mn></msub><mo>+</mo><msub><mi>e</mi><mn>4</mn></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
X_3&amp;=b_{13}X_1+b_{23}X_2+e_3\\
X_4&amp;=b_{14}X_1+b_{24}X_2+b_{34}X_3+e_4
\end{aligned}
</annotation></semantics></math></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span>font_family <span class="op">=</span> <span class="va">my_font</span>, font_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu">observed</span><span class="op">(</span><span class="op">)</span> </span>
<span>   <span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu">observed</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">x1</span>, <span class="st">"below"</span>, sep <span class="op">=</span> <span class="fl">2.25</span><span class="op">)</span> </span>
<span>   <span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu">observed</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="fu"><a href="../reference/midpoint.html">midpoint</a></span><span class="op">(</span><span class="va">x1</span><span class="op">@</span><span class="va">east</span>,</span>
<span>                   <span class="va">x2</span><span class="op">@</span><span class="va">east</span><span class="op">)</span>, </span>
<span>          <span class="st">"right"</span><span class="op">)</span> </span>
<span>   <span class="va">x4</span> <span class="op">&lt;-</span> <span class="fu">observed</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">x3</span>, <span class="st">"right"</span>, sep <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span>   <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind.html">bind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x3</span>, <span class="va">x4</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu">lb_observed</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"*X*~"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="st">"~"</span><span class="op">)</span>, <span class="va">x</span><span class="op">@</span><span class="va">center</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="va">pred</span> <span class="op">&lt;-</span>    <span class="fu"><a href="../reference/bind.html">bind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x2</span>, <span class="va">x1</span>, <span class="va">x3</span>, <span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">)</span></span>
<span>   <span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind.html">bind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x3</span>, <span class="va">x3</span>, <span class="va">x4</span>, <span class="va">x4</span>, <span class="va">x4</span><span class="op">)</span><span class="op">)</span></span>
<span>   <span class="fu">direct</span><span class="op">(</span><span class="va">pred</span>,<span class="va">outcome</span>, </span>
<span>          label <span class="op">=</span> <span class="fu">lb_direct</span><span class="op">(</span></span>
<span>            label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"*b*~23~"</span>,</span>
<span>                      <span class="st">"*b*~13~"</span>,</span>
<span>                      <span class="st">"*b*~34~"</span>,</span>
<span>                      <span class="st">"*b*~14~"</span>,</span>
<span>                      <span class="st">"*b*~24~"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">endogenous</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind.html">bind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x3</span>,<span class="va">x4</span><span class="op">)</span><span class="op">)</span></span>
<span>   <span class="va">e</span> <span class="op">&lt;-</span> <span class="fu">error</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">lb_error</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"*e*~"</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span>, <span class="st">"~"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">endogenous</span>, </span>
<span>          where <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"right"</span><span class="op">)</span>,</span>
<span>          sep <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="fu">direct</span><span class="op">(</span><span class="va">e</span>, <span class="va">endogenous</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">covariance</span><span class="op">(</span><span class="va">x2</span><span class="op">@</span><span class="va">west</span>, </span>
<span>             <span class="va">x1</span><span class="op">@</span><span class="va">west</span>,</span>
<span>             label <span class="op">=</span> <span class="fu">lb_direct</span><span class="op">(</span><span class="st">"*r*~12~"</span>, position <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-pathanalysis" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-pathanalysis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causalpaths_files/figure-html/fig-pathanalysis-1.svg" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pathanalysis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 5: A path diagram of a path analysis model
</figcaption></figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="path-diagrams-for-exploratory-factor-analysis">Path Diagrams for Exploratory Factor Analysis<a class="anchor" aria-label="anchor" href="#path-diagrams-for-exploratory-factor-analysis"></a>
</h3>
<p>Exploratory factor analysis (EFA) assumes that observed variables intercorrelate because there is a smaller number of latent variables influence multiple observed variables. In <a href="#fig-efa" class="quarto-xref">Figure 6</a>, there are 6 observed variables <em>x</em> that intercorrelate because 2 latent factors <em>f</em> act as common causes.</p>
<p>EFA will find the loadings from latent to observed variables that best account for the observed correlations among variables. Some portion of the observed variables is independent of the latent factors. These independent influences can be thought of as uniquenesses <em>u</em>. Thus, the structural model is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>Λ</mi><mi>f</mi><mo>+</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">
x=\Lambda f+u
</annotation></semantics></math> where <em>x</em> is the vector observed variables, <em>f</em> is the vector of latent factors, <em>u</em> is the vector of latent uniquenesses, and Λ is the matrix of loadings that quantify the strength of the effects of <em>f</em> on <em>x</em>.</p>
<p>The observed variables <em>x</em>, latent factors <em>f</em>, and uniquenesses <em>u</em> each have their own covariance matrices:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>Σ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mtext mathvariant="normal">cov</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>Φ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mtext mathvariant="normal">cov</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>Θ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mtext mathvariant="normal">cov</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\Sigma&amp;=\text{cov}(x)\\
\Phi&amp;=\text{cov}(f)\\
\Theta&amp;=\text{cov}(u)
\end{aligned}
</annotation></semantics></math></p>
<p>The model-implied covariance matrix for the observed variables is a function of the loading matrix Λ and the covariance matrices Φ and Θ:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>Σ</mi><mo accent="true">̂</mo></mover></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>Λ</mi><mi>Φ</mi><mi>Λ</mi><mi>′</mi><mo>+</mo><mi>Θ</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>21</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>22</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>13</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>23</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>14</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>24</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>15</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>25</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>16</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>26</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ϕ</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ϕ</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>ϕ</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>ϕ</mi><mn>22</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>21</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>22</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>13</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>23</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>14</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>24</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>15</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>25</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>16</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>λ</mi><mn>26</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mi>′</mi><mo>+</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>θ</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>θ</mi><mn>22</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>θ</mi><mn>33</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>θ</mi><mn>44</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>θ</mi><mn>55</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>θ</mi><mn>66</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\hat{\Sigma}&amp;=\Lambda\Phi\Lambda'+\Theta\\
&amp;=\begin{bmatrix}
\lambda_{11} &amp; \lambda_{21}\\
\lambda_{12} &amp; \lambda_{22}\\
\lambda_{13} &amp; \lambda_{23}\\
\lambda_{14} &amp; \lambda_{24}\\
\lambda_{15} &amp; \lambda_{25}\\
\lambda_{16} &amp; \lambda_{26}\\
\end{bmatrix}\begin{bmatrix}\phi_{11} &amp; \phi_{12}\\ \phi_{12} &amp; \phi_{22}\end{bmatrix}\begin{bmatrix}
\lambda_{11} &amp; \lambda_{21}\\
\lambda_{12} &amp; \lambda_{22}\\
\lambda_{13} &amp; \lambda_{23}\\
\lambda_{14} &amp; \lambda_{24}\\
\lambda_{15} &amp; \lambda_{25}\\
\lambda_{16} &amp; \lambda_{26}\\
\end{bmatrix}'+\begin{bmatrix}
\theta_{11} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; \theta_{22} &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; \theta_{33} &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; \theta_{44} &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \theta_{55} &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \theta_{66}
\end{bmatrix}
\end{aligned}
</annotation></semantics></math></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_fills</span> <span class="op">&lt;-</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, begin <span class="op">=</span> <span class="fl">.3</span>, end <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/class_color.html">class_color</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rconsortium.github.io/S7/reference/props.html" class="external-link">set_props</a></span><span class="op">(</span>saturation <span class="op">=</span> <span class="fl">.6</span>, brightness <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span>font_family <span class="op">=</span> <span class="va">my_font</span>, font_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_array.html">ob_array</a></span><span class="op">(</span><span class="fu"><a href="../reference/ob_ellipse.html">ob_ellipse</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="fl">8</span>, </span>
<span>                               color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                               fill <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                    k <span class="op">=</span> <span class="fl">6</span>, </span>
<span>                    sep <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"*X*~"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="st">"~"</span><span class="op">)</span>,</span>
<span>           center <span class="op">=</span> <span class="va">x</span><span class="op">@</span><span class="va">center</span>,</span>
<span>           size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>           fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>           nudge_y <span class="op">=</span> <span class="op">-</span><span class="fl">.1</span>,</span>
<span>           color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span>radius <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">@</span><span class="va">bounding_box</span><span class="op">@</span><span class="va">width</span> <span class="op">/</span> <span class="fl">2</span>, </span>
<span>                   fill <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                   color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                   label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>                     <span class="st">"*f*~1~"</span>, </span>
<span>                     size <span class="op">=</span> <span class="fl">48</span>,</span>
<span>                     nudge_y <span class="op">=</span> <span class="op">-</span><span class="fl">.2</span>,</span>
<span>                     fill <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>                     color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="../reference/midpoint.html">midpoint</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, </span>
<span>          where <span class="op">=</span> <span class="st">"above"</span>, </span>
<span>          sep <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">@</span><span class="va">bounding_box</span><span class="op">@</span><span class="va">width</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span>radius <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">@</span><span class="va">bounding_box</span><span class="op">@</span><span class="va">width</span> <span class="op">/</span> <span class="fl">2</span>, </span>
<span>                   fill <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>                   color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                   label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>                     <span class="st">"*f*~2~"</span>, </span>
<span>                     size <span class="op">=</span> <span class="fl">48</span>,</span>
<span>                     nudge_y <span class="op">=</span> <span class="op">-</span><span class="fl">.2</span>,</span>
<span>                     fill <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>                     color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="fu"><a href="../reference/midpoint.html">midpoint</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>, </span>
<span>          where <span class="op">=</span> <span class="st">"above"</span>, </span>
<span>          sep <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">@</span><span class="va">bounding_box</span><span class="op">@</span><span class="va">width</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">f1x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">f1</span>, </span>
<span>                  <span class="va">x</span><span class="op">@</span><span class="va">north</span>, </span>
<span>                  resect <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                  color <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="va">f2x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">f2</span>, </span>
<span>                  <span class="va">x</span><span class="op">@</span><span class="va">north</span>, </span>
<span>                  resect <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                  color <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/intersection.html">intersection</a></span><span class="op">(</span><span class="va">f1</span><span class="op">@</span><span class="va">tangent_at</span><span class="op">(</span><span class="fl">45</span><span class="op">)</span>, <span class="va">f2</span><span class="op">@</span><span class="va">tangent_at</span><span class="op">(</span><span class="fl">135</span><span class="op">)</span><span class="op">)</span></span>
<span>   <span class="fu"><a href="../reference/ob_arc.html">ob_arc</a></span><span class="op">(</span>center <span class="op">=</span> <span class="va">a</span>, </span>
<span>          radius <span class="op">=</span> <span class="fu"><a href="../reference/distance.html">distance</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">f1</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fl">45</span><span class="op">)</span><span class="op">)</span>, </span>
<span>          start <span class="op">=</span> <span class="op">(</span><span class="va">f1</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fl">45</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span><span class="op">)</span><span class="op">@</span><span class="va">theta</span>, </span>
<span>          end <span class="op">=</span> <span class="op">(</span><span class="va">f2</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fl">135</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span><span class="op">)</span><span class="op">@</span><span class="va">theta</span>,</span>
<span>          color <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>          resect <span class="op">=</span> <span class="fl">2</span>, </span>
<span>          linewidth <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>          arrowhead_length <span class="op">=</span> <span class="fl">7</span>,</span>
<span>          arrow_head <span class="op">=</span> <span class="fu"><a href="../reference/arrowhead.html">arrowhead</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          arrow_fins <span class="op">=</span> <span class="fu"><a href="../reference/arrowhead.html">arrowhead</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"&amp;phi;~12~"</span>,</span>
<span>                           color <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                           vjust <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>                           size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"*&amp;lambda;*~2"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="st">"~"</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="../reference/intersection.html">intersection</a></span><span class="op">(</span><span class="va">f1x</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="fl">1.2</span>,<span class="fl">0</span><span class="op">)</span>, <span class="va">f2x</span><span class="op">)</span>, </span>
<span>            size <span class="op">=</span> <span class="fl">14</span>,</span>
<span>            label.padding <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"*&amp;lambda;*~1"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="st">"~"</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="../reference/intersection.html">intersection</a></span><span class="op">(</span><span class="va">f2x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>,<span class="fl">0</span><span class="op">)</span>, <span class="va">f1x</span><span class="op">)</span>, </span>
<span>            size <span class="op">=</span> <span class="fl">14</span>,</span>
<span>            label.padding <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">2</span>, l <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_variance.html">ob_variance</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">f1</span>,</span>
<span>    color <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"&amp;phi;~11~"</span>, color <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_variance.html">ob_variance</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">f2</span>,</span>
<span>    color <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"&amp;phi;~22~"</span>, color <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span></span>
<span>    radius <span class="op">=</span> <span class="fl">.75</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"*u*~"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="st">"~"</span><span class="op">)</span>,</span>
<span>      fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">14</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">@</span><span class="va">place</span><span class="op">(</span><span class="va">x</span>, <span class="st">"below"</span>, sep <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">u</span>, <span class="va">x</span>, color <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, resect <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_variance.html">ob_variance</a></span><span class="op">(</span></span>
<span>    <span class="va">u</span>,</span>
<span>    where <span class="op">=</span> <span class="st">"south"</span>,</span>
<span>    color <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    theta <span class="op">=</span> <span class="fl">65</span>,</span>
<span>    looseness <span class="op">=</span> <span class="fl">2.3</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"*&amp;theta;*~"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span> <span class="op">*</span> <span class="fl">11</span>, <span class="st">"~"</span><span class="op">)</span>,</span>
<span>      color <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>      label.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">12</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-efa" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-efa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causalpaths_files/figure-html/fig-efa-1.svg" width="624">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-efa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 6: Exploratory Factor Analysis with Two Latent Factors and Six Observed Variables
</figcaption></figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="path-diagrams-for-principal-components-analysis">Path Diagrams for Principal Components Analysis<a class="anchor" aria-label="anchor" href="#path-diagrams-for-principal-components-analysis"></a>
</h3>
<p>Principal components analysis (PCA) is similar to exploratory factor analysis (EFA) in that it finds latent factors from covariances among observed variables. The underlying model of PCA differs from EFA in that the indicators are <em>formative</em> rather than <em>reflective</em>. Because the principal components are fully determined by the observed variables, they have no error term. That is, they act as weighted summaries of the observed variables. In general, PCA creates latent variables that better summarize the observed data, and EFA creates latent variables that better approximate the underlying structure of the data.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span>font_family <span class="op">=</span> <span class="va">my_font</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># observed variables</span></span>
<span>  <span class="op">{</span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_ellipse.html">ob_ellipse</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="fl">10</span>, a <span class="op">=</span> <span class="fl">.6</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="../reference/ob_array.html">ob_array</a></span><span class="op">(</span><span class="fl">5</span>, sep <span class="op">=</span> <span class="fl">.2</span>, fill <span class="op">=</span> <span class="fu"><a href="../reference/class_color.html">class_color</a></span><span class="op">(</span><span class="va">my_fills</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.6</span>, <span class="fl">.9</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="co"># principal components</span></span>
<span>  <span class="op">{</span><span class="va">pc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">o</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span>, <span class="st">"above"</span>, <span class="fl">2</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="co"># direct effects from o to pc</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/unbind.html">unbind</a></span><span class="op">(</span><span class="va">pc</span><span class="op">)</span>, \<span class="op">(</span><span class="va">pci</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">o</span><span class="op">@</span><span class="va">north</span>, </span>
<span>              to <span class="op">=</span> <span class="va">pci</span>, </span>
<span>              color <span class="op">=</span> <span class="va">pci</span><span class="op">@</span><span class="va">fill</span>,</span>
<span>              resect <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">@</span><span class="va">geom</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># covariances among observed variables</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, \<span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">offset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">1.5</span><span class="op">)</span> <span class="op">*</span> <span class="fl">.11</span></span>
<span>    <span class="fu"><a href="../reference/ob_covariance.html">ob_covariance</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">o</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">@</span><span class="va">south</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="va">offset</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span> <span class="op">-</span> <span class="va">i</span><span class="op">)</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>      y <span class="op">=</span> <span class="va">o</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">@</span><span class="va">south</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="op">-</span><span class="va">offset</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span> <span class="op">-</span> <span class="va">i</span><span class="op">)</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>      bend <span class="op">=</span> <span class="fl">45</span>,</span>
<span>      looseness <span class="op">=</span> <span class="fl">1.4</span>,</span>
<span>      linewidth <span class="op">=</span> <span class="fl">.5</span>, </span>
<span>      arrowhead_length <span class="op">=</span> <span class="fl">6</span>,</span>
<span>      color <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="op">)</span><span class="op">@</span><span class="va">geom</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co"># Labels</span></span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"Formative&lt;br&gt;Indicators"</span>, size <span class="op">=</span> <span class="fl">16</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">o</span><span class="op">@</span><span class="va">bounding_box</span><span class="op">@</span><span class="va">east</span>, sep <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"Principal&lt;br&gt;Components"</span>, size <span class="op">=</span> <span class="fl">24</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">pc</span><span class="op">@</span><span class="va">bounding_box</span><span class="op">@</span><span class="va">east</span>, sep <span class="op">=</span> <span class="fl">1.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Invisible point to prevent label from clipping</span></span>
<span>  <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="va">o</span><span class="op">@</span><span class="va">bounding_box</span><span class="op">@</span><span class="va">east</span><span class="op">@</span><span class="va">x</span> <span class="op">+</span> <span class="fl">1.2</span>, <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-pca" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-pca-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causalpaths_files/figure-html/fig-pca-1.svg" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pca-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 7: A path diagram for a principal components analysis model
</figcaption></figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="path-diagrams-for-confirmatory-factor-analysis">Path Diagrams for Confirmatory Factor Analysis<a class="anchor" aria-label="anchor" href="#path-diagrams-for-confirmatory-factor-analysis"></a>
</h3>
<p><a href="#fig-latent3" class="quarto-xref">Figure 8</a> shows the primary ingredients of a latent variable model. <em>Latent variables</em> are not observed directly but are inferred from the correlations among observed variables. Latent variables are displayed as circles or ellipses. Their variances are depicted as curved double-headed arrows that circle back to the same latent variable. The observed variables from which latent variables are inferred are called <em>indicator variables</em>. The direct effects from a latent variable to its indicators are called <em>loadings</em>. The variability in indicator variables that is not explained by latent variables are explained by latent <em>residuals</em> (AKA <em>errors</em>). Each residual has its own variance. In some path diagrams, residual variances are affixed directly to observed variables, and the residual variables are omitted.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span>font_family <span class="op">=</span> <span class="va">my_font</span>, font_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Place a latent variable at the top</span></span>
<span>  <span class="op">{</span><span class="va">l1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span>radius <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="co"># Place an array of observed variables below the circle</span></span>
<span>  <span class="op">{</span><span class="va">o3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_ellipse.html">ob_ellipse</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="fl">9</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">l1</span>, </span>
<span>          where <span class="op">=</span> <span class="st">"below"</span>, </span>
<span>          sep <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/ob_array.html">ob_array</a></span><span class="op">(</span></span>
<span>      k <span class="op">=</span> <span class="fl">3</span>,</span>
<span>      where <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      sep <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="co"># Connect the latent to the observed variables at the north anchor point</span></span>
<span>  <span class="op">{</span><span class="va">l1_o3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">l1</span>, </span>
<span>                    <span class="va">o3</span><span class="op">@</span><span class="va">north</span>, </span>
<span>                    resect <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="co"># Place error terms below each observed variable</span></span>
<span>  <span class="op">{</span><span class="va">e3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span>radius <span class="op">=</span> <span class="fl">.75</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">o3</span>,</span>
<span>          where <span class="op">=</span> <span class="st">"below"</span>,</span>
<span>          sep <span class="op">=</span> <span class="fl">.85</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="co"># Connect the error terms to the observed variables</span></span>
<span>  <span class="op">{</span><span class="va">e3_o3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">e3</span>, <span class="va">o3</span>, resect <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="co"># latent variance1</span></span>
<span>  <span class="op">{</span><span class="va">v_l1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_variance.html">ob_variance</a></span><span class="op">(</span><span class="va">l1</span>, where <span class="op">=</span> <span class="st">"north"</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="co"># label(1, v_l1@midpoint()) + </span></span>
<span>  <span class="op">{</span><span class="va">v_e3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_variance.html">ob_variance</a></span><span class="op">(</span></span>
<span>    <span class="va">e3</span>,</span>
<span>    where <span class="op">=</span> <span class="st">"south"</span>,</span>
<span>    looseness <span class="op">=</span> <span class="fl">1.4</span>,</span>
<span>    resect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"pt"</span><span class="op">)</span>,</span>
<span>    arrowhead_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">7</span>, <span class="st">"pt"</span><span class="op">)</span>, </span>
<span>    arrow_head <span class="op">=</span> <span class="fu"><a href="../reference/arrowhead.html">arrowhead</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    arrow_fins <span class="op">=</span> <span class="fu"><a href="../reference/arrowhead.html">arrowhead</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">lb_indicator</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"Indicator&lt;br&gt;Variables"</span>, </span>
<span>                            color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">o3</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">@</span><span class="va">west</span>, <span class="st">"west"</span>, sep <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"Loadings"</span>, </span>
<span>           <span class="va">lb_indicator</span><span class="op">@</span><span class="va">center</span> <span class="op"><a href="../reference/perpendicular_point.html">%|-%</a></span> <span class="fu"><a href="../reference/midpoint.html">midpoint</a></span><span class="op">(</span><span class="va">l1</span>, <span class="va">o3</span><span class="op">@</span><span class="va">bounding_box</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"Residuals"</span>, </span>
<span>           <span class="va">lb_indicator</span><span class="op">@</span><span class="va">center</span> <span class="op"><a href="../reference/perpendicular_point.html">%|-%</a></span> <span class="va">e3</span><span class="op">@</span><span class="va">bounding_box</span><span class="op">@</span><span class="va">center</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"Latent&lt;br&gt;Variable"</span>, <span class="va">lb_indicator</span><span class="op">@</span><span class="va">center</span> <span class="op"><a href="../reference/perpendicular_point.html">%|-%</a></span> <span class="va">l1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"Latent&lt;br&gt;Variance"</span>, </span>
<span>           <span class="va">lb_indicator</span><span class="op">@</span><span class="va">center</span> <span class="op"><a href="../reference/perpendicular_point.html">%|-%</a></span> <span class="va">l1</span><span class="op">@</span><span class="va">normal_at</span><span class="op">(</span></span>
<span>             <span class="st">"north"</span>, </span>
<span>             distance <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"Residual&lt;br&gt;Variances"</span>, </span>
<span>           <span class="va">lb_indicator</span><span class="op">@</span><span class="va">center</span> <span class="op"><a href="../reference/perpendicular_point.html">%|-%</a></span> <span class="va">e3</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">@</span><span class="va">normal_at</span><span class="op">(</span></span>
<span>             <span class="st">"south"</span>, </span>
<span>             distance <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-latent3" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-latent3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causalpaths_files/figure-html/fig-latent3-1.svg" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-latent3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 8: A latent variable with three observed indicators and three latent error terms.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_fills</span> <span class="op">&lt;-</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, begin <span class="op">=</span> <span class="fl">.3</span>, end <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/class_color.html">class_color</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rconsortium.github.io/S7/reference/props.html" class="external-link">set_props</a></span><span class="op">(</span>saturation <span class="op">=</span> <span class="fl">.6</span>, brightness <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_path_color</span> <span class="op">&lt;-</span> <span class="st">"gray40"</span></span>
<span><span class="va">my_resect</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">broad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gv"</span>, <span class="st">"Gf"</span>, <span class="st">"Gc"</span><span class="op">)</span></span>
<span><span class="va">g2broad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gv <span class="op">=</span> <span class="fl">.84</span>, Gf <span class="op">=</span> <span class="fl">.95</span>, Gc <span class="op">=</span> <span class="fl">.80</span><span class="op">)</span></span>
<span></span>
<span><span class="va">broad2indicator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Gv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.78</span>, <span class="fl">.84</span>, <span class="fl">.91</span><span class="op">)</span>,</span>
<span>                        Gf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.88</span>, <span class="fl">.81</span>, <span class="fl">.74</span><span class="op">)</span>,</span>
<span>                        Gc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.74</span>, <span class="fl">.91</span>, <span class="fl">.93</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">broad_variance</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">g2broad</span> <span class="op">^</span> <span class="fl">2</span></span>
<span></span>
<span><span class="va">latent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_circle</span>, </span>
<span>                    color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>  </span>
<span></span>
<span><span class="va">lb_latent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_label</span>, </span>
<span>                            size <span class="op">=</span> <span class="fl">30</span>, </span>
<span>                            fill <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>                            color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">observed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_ellipse</span>, </span>
<span>                           a <span class="op">=</span> <span class="fl">.5</span>, </span>
<span>                           b <span class="op">=</span> <span class="fl">.5</span>, </span>
<span>                           m1 <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                           <span class="co"># fill = my_fill,</span></span>
<span>                           color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lb_observed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span></span>
<span>  <span class="va">ob_label</span>, </span>
<span>  size <span class="op">=</span> <span class="fl">15</span>, </span>
<span>  fill <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>  color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  nudge_y <span class="op">=</span> <span class="op">-</span><span class="fl">.04</span><span class="op">)</span></span>
<span></span>
<span><span class="va">direct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span></span>
<span>  <span class="va">connect</span>,</span>
<span>  resect <span class="op">=</span> <span class="va">my_resect</span>,</span>
<span>  color <span class="op">=</span> <span class="va">my_path_color</span>,</span>
<span>  arrow_head <span class="op">=</span> <span class="fu"><a href="../reference/arrowhead.html">arrowhead</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  linewidth <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>  length_head <span class="op">=</span> <span class="fl">6</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">lb_direct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span></span>
<span>  <span class="va">ob_label</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  color <span class="op">=</span> <span class="va">lb_color</span>,</span>
<span>  angle <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  vjust <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>  position <span class="op">=</span> <span class="fl">.46</span>,</span>
<span>  label.padding <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">2</span>, b <span class="op">=</span> <span class="fl">0</span>, l <span class="op">=</span> <span class="fl">2</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">var_latent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span></span>
<span>  <span class="va">ob_variance</span>, </span>
<span>  theta <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  resect <span class="op">=</span> <span class="va">my_resect</span>,</span>
<span>  color <span class="op">=</span> <span class="va">my_path_color</span>, </span>
<span>  looseness <span class="op">=</span> <span class="fl">.9</span>, </span>
<span>  linewidth <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>  arrow_head <span class="op">=</span> <span class="fu"><a href="../reference/arrowhead.html">arrowhead</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  arrow_fins <span class="op">=</span> <span class="fu"><a href="../reference/arrowhead.html">arrowhead</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  arrowhead_length <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lb_variance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span></span>
<span>  <span class="va">lb_direct</span>,</span>
<span>  position <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>  straight <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span>font_family <span class="op">=</span> <span class="va">my_font</span>, font_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">latent</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">lb_latent</span><span class="op">(</span><span class="st">"*g*"</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"gray15"</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="fu">var_latent</span><span class="op">(</span><span class="va">g</span>, label <span class="op">=</span> <span class="fu">lb_variance</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">Gx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">g</span>,where <span class="op">=</span> <span class="st">"below"</span>, sep <span class="op">=</span> <span class="fl">1.6</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/ob_array.html">ob_array</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                sep <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                label <span class="op">=</span> <span class="fu">lb_latent</span><span class="op">(</span><span class="va">broad</span>, </span>
<span>                                  vjust <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span>,</span>
<span>                fill <span class="op">=</span> <span class="va">my_fills</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu">var_latent</span><span class="op">(</span><span class="va">Gx</span>, </span>
<span>             where <span class="op">=</span> <span class="st">"left"</span>, </span>
<span>             color <span class="op">=</span> <span class="va">Gx</span><span class="op">@</span><span class="va">fill</span>,</span>
<span>             label <span class="op">=</span> <span class="fu">lb_variance</span><span class="op">(</span></span>
<span>               <span class="fu"><a href="../reference/round_probability.html">round_probability</a></span><span class="op">(</span><span class="va">broad_variance</span>, </span>
<span>                                 phantom_text <span class="op">=</span> <span class="st">"."</span><span class="op">)</span>,</span>
<span>               color <span class="op">=</span> <span class="va">Gx</span><span class="op">@</span><span class="va">fill</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">pGx</span> <span class="op">&lt;-</span> <span class="fu">direct</span><span class="op">(</span><span class="va">g</span>, <span class="va">Gx</span>, color <span class="op">=</span> <span class="va">Gx</span><span class="op">@</span><span class="va">fill</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="fu">lb_direct</span><span class="op">(</span></span>
<span>    label <span class="op">=</span> <span class="fu"><a href="../reference/round_probability.html">round_probability</a></span><span class="op">(</span><span class="va">g2broad</span>, </span>
<span>                              phantom_text <span class="op">=</span> <span class="st">"."</span><span class="op">)</span>, </span>
<span>    center <span class="op">=</span> <span class="va">pGx</span><span class="op">@</span><span class="va">line</span><span class="op">@</span><span class="va">point_at_y</span><span class="op">(</span><span class="va">pGx</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">@</span><span class="va">midpoint</span><span class="op">(</span></span>
<span>      position <span class="op">=</span> <span class="fl">.47</span><span class="op">)</span><span class="op">@</span><span class="va">y</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="va">Gx</span><span class="op">@</span><span class="va">fill</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="co"># list----</span></span>
<span>  <span class="op">{</span><span class="va">vv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_ob.html">map_ob</a></span><span class="op">(</span><span class="va">Gx</span>, \<span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">o1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="fu">observed</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">b</span><span class="op">@</span><span class="va">fill</span><span class="op">)</span>, </span>
<span>                from <span class="op">=</span> <span class="va">b</span>, </span>
<span>                where <span class="op">=</span> <span class="st">"south"</span>,</span>
<span>                sep <span class="op">=</span> <span class="fl">1.6</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_array.html">ob_array</a></span><span class="op">(</span></span>
<span>      <span class="va">o1</span>,</span>
<span>      k <span class="op">=</span> <span class="fl">3</span>, </span>
<span>      sep <span class="op">=</span> <span class="fl">.2</span>,</span>
<span>      fill <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_chr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.6</span>, <span class="fl">.75</span>, <span class="fl">.9</span><span class="op">)</span>, <span class="fu">tinter</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/tinter/man/lighten.html" class="external-link">lighten</a></span>, x <span class="op">=</span> <span class="va">o1</span><span class="op">@</span><span class="va">fill</span><span class="op">)</span>,</span>
<span>      label <span class="op">=</span> <span class="fu">lb_observed</span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>          <span class="va">b</span><span class="op">@</span><span class="va">label</span><span class="op">@</span><span class="va">label</span>, </span>
<span>          <span class="st">"~"</span>, </span>
<span>          <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, </span>
<span>          <span class="st">"~"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">direct</span><span class="op">(</span><span class="va">b</span>, <span class="va">o</span><span class="op">@</span><span class="va">north</span>, color <span class="op">=</span> <span class="va">b</span><span class="op">@</span><span class="va">fill</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">l</span> <span class="op">&lt;-</span> <span class="fu">lb_direct</span><span class="op">(</span></span>
<span>      <span class="fu"><a href="../reference/round_probability.html">round_probability</a></span><span class="op">(</span></span>
<span>        <span class="va">broad2indicator</span><span class="op">[[</span><span class="va">b</span><span class="op">@</span><span class="va">label</span><span class="op">@</span><span class="va">label</span><span class="op">]</span><span class="op">]</span>,</span>
<span>        phantom_text <span class="op">=</span> <span class="st">"."</span><span class="op">)</span>, </span>
<span>      center <span class="op">=</span> <span class="va">p</span><span class="op">@</span><span class="va">line</span><span class="op">@</span><span class="va">point_at_y</span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">@</span><span class="va">midpoint</span><span class="op">(</span>position <span class="op">=</span> <span class="fl">.47</span><span class="op">)</span><span class="op">@</span><span class="va">y</span><span class="op">)</span>,</span>
<span>      color <span class="op">=</span> <span class="va">b</span><span class="op">@</span><span class="va">fill</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_variance.html">ob_variance</a></span><span class="op">(</span></span>
<span>      <span class="va">o</span>,</span>
<span>      where <span class="op">=</span> <span class="st">"south"</span>,</span>
<span>      bend <span class="op">=</span> <span class="op">-</span><span class="fl">15</span>,</span>
<span>      looseness <span class="op">=</span> <span class="fl">1.7</span>,</span>
<span>      resect <span class="op">=</span> <span class="va">my_resect</span>,</span>
<span>      color <span class="op">=</span> <span class="va">b</span><span class="op">@</span><span class="va">fill</span>,</span>
<span>      theta <span class="op">=</span> <span class="fl">70</span>,</span>
<span>      linewidth <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>      label <span class="op">=</span> <span class="fu">lb_variance</span><span class="op">(</span></span>
<span>        <span class="fu"><a href="../reference/round_probability.html">round_probability</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">broad2indicator</span><span class="op">[[</span><span class="va">b</span><span class="op">@</span><span class="va">label</span><span class="op">@</span><span class="va">label</span><span class="op">]</span><span class="op">]</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        color <span class="op">=</span> <span class="va">b</span><span class="op">@</span><span class="va">fill</span><span class="op">)</span>,</span>
<span>      arrow_head <span class="op">=</span> <span class="fu"><a href="../reference/arrowhead.html">arrowhead</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      arrow_fins <span class="op">=</span> <span class="fu"><a href="../reference/arrowhead.html">arrowhead</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      arrowhead_length <span class="op">=</span> <span class="fl">6</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">o</span>, <span class="va">p</span>, <span class="va">v</span>, <span class="va">l</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op">}</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-path" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-path-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causalpaths_files/figure-html/fig-path-1.svg" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-path-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 9: A structural equation path diagram
</figcaption></figure>
</div>
</div>
</div>
<p>In <a href="#fig-wedge" class="quarto-xref">Figure 10</a>, the same model from <a href="#fig-path" class="quarto-xref">Figure 9</a> is displayed showing variance proportions. The observed and latent variables all have an area of 1. The residual effects have areas proportional to their variances. The pie wedges in the endogenous latent variables and stacked bars in the observed variables have areas equal to the variance portions of their source variables.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span>font_family <span class="op">=</span> <span class="va">my_font</span>, font_size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">latent</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">lb_latent</span><span class="op">(</span><span class="st">"*g*"</span><span class="op">)</span>, </span>
<span>               fill <span class="op">=</span> <span class="st">"gray15"</span>, </span>
<span>               radius <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">pi</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="va">Gx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">g</span>,where <span class="op">=</span> <span class="st">"below"</span>, sep <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/ob_array.html">ob_array</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                sep <span class="op">=</span> <span class="fl">2.4</span>, </span>
<span>                label <span class="op">=</span> <span class="fu">lb_latent</span><span class="op">(</span><span class="va">broad</span>, </span>
<span>                                  vjust <span class="op">=</span> <span class="fl">.6</span>,</span>
<span>                                  color <span class="op">=</span> <span class="st">"gray15"</span>,</span>
<span>                                  size <span class="op">=</span> <span class="fl">28</span><span class="op">)</span>,</span>
<span>                fill <span class="op">=</span> <span class="st">"gray15"</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">d_Gx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">my_fills</span>,</span>
<span>    radius <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">broad_variance</span> <span class="op">/</span> <span class="va">pi</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">Gx</span>, where <span class="op">=</span> <span class="st">"left"</span>, sep <span class="op">=</span> <span class="fl">.45</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu">direct</span><span class="op">(</span><span class="va">d_Gx</span>, </span>
<span>          <span class="va">Gx</span>, </span>
<span>          color <span class="op">=</span> <span class="va">my_fills</span>, </span>
<span>          resect <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">pGx</span> <span class="op">&lt;-</span> <span class="fu">direct</span><span class="op">(</span><span class="va">g</span>, <span class="va">Gx</span>, color <span class="op">=</span> <span class="va">Gx</span><span class="op">@</span><span class="va">fill</span>, resect <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="fu">lb_direct</span><span class="op">(</span></span>
<span>    label <span class="op">=</span> <span class="fu"><a href="../reference/round_probability.html">round_probability</a></span><span class="op">(</span><span class="va">g2broad</span>,</span>
<span>                              phantom_text <span class="op">=</span> <span class="st">"."</span><span class="op">)</span>,</span>
<span>    center <span class="op">=</span> <span class="va">pGx</span><span class="op">@</span><span class="va">line</span><span class="op">@</span><span class="va">point_at_y</span><span class="op">(</span><span class="va">pGx</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">@</span><span class="va">midpoint</span><span class="op">(</span></span>
<span>      position <span class="op">=</span> <span class="fl">.46</span><span class="op">)</span><span class="op">@</span><span class="va">y</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="va">Gx</span><span class="op">@</span><span class="va">fill</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_arc.html">ob_wedge</a></span><span class="op">(</span>center <span class="op">=</span> <span class="va">Gx</span><span class="op">@</span><span class="va">center</span>, </span>
<span>           radius <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">pi</span><span class="op">)</span>,</span>
<span>           start <span class="op">=</span> <span class="fu"><a href="../reference/ob_angle.html">turn</a></span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_angle.html">turn</a></span><span class="op">(</span><span class="va">broad_variance</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>,</span>
<span>           end <span class="op">=</span> <span class="fu"><a href="../reference/ob_angle.html">turn</a></span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="../reference/ob_angle.html">turn</a></span><span class="op">(</span><span class="va">broad_variance</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>,</span>
<span>           fill <span class="op">=</span> <span class="va">my_fills</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">lb_latent</span><span class="op">(</span><span class="va">broad</span>, center <span class="op">=</span> <span class="va">Gx</span><span class="op">@</span><span class="va">center</span>, vjust <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, \<span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">b</span> <span class="op">&lt;-</span> <span class="va">Gx</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="op">)</span>, from <span class="op">=</span> <span class="va">b</span>, where <span class="op">=</span> <span class="st">"south"</span>, sep <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span>    <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="op">)</span>, from <span class="op">=</span> <span class="va">p2</span>, where <span class="op">=</span> <span class="st">"left"</span>, sep <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span></span>
<span>    <span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="op">)</span>, from <span class="op">=</span> <span class="va">p2</span>, where <span class="op">=</span> <span class="st">"right"</span>, sep <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind.html">bind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p1</span>,<span class="va">p2</span>,<span class="va">p3</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">b_text</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">@</span><span class="va">label</span><span class="op">@</span><span class="va">label</span></span>
<span>    </span>
<span>    <span class="va">lb_o</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">b_text</span>, <span class="st">"~"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"~"</span><span class="op">)</span>,</span>
<span>                     center <span class="op">=</span> <span class="va">p</span> <span class="op">-</span> <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.55</span><span class="op">)</span>,</span>
<span>                     color <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>                     size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                     fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span>    </span>
<span>    </span>
<span>    </span>
<span>    <span class="va">b_p</span> <span class="op">&lt;-</span> <span class="fu">direct</span><span class="op">(</span><span class="va">b</span>, <span class="va">p</span>, color <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, resect <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">l_b_p</span> <span class="op">&lt;-</span> <span class="fu">lb_direct</span><span class="op">(</span></span>
<span>      <span class="fu"><a href="../reference/round_probability.html">round_probability</a></span><span class="op">(</span><span class="va">broad2indicator</span><span class="op">[[</span><span class="va">b_text</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                        phantom_text <span class="op">=</span> <span class="st">"."</span><span class="op">)</span>, </span>
<span>      center <span class="op">=</span> <span class="va">b_p</span><span class="op">@</span><span class="va">line</span><span class="op">@</span><span class="va">point_at_y</span><span class="op">(</span><span class="va">b_p</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">@</span><span class="va">midpoint</span><span class="op">(</span><span class="fl">.46</span><span class="op">)</span><span class="op">@</span><span class="va">y</span><span class="op">)</span>,</span>
<span>      color <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">r_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_rectangle.html">ob_rectangle</a></span><span class="op">(</span></span>
<span>      north <span class="op">=</span> <span class="va">p</span>, </span>
<span>      fill <span class="op">=</span> <span class="va">g</span><span class="op">@</span><span class="va">fill</span>,</span>
<span>      color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      width <span class="op">=</span> <span class="fl">1</span>, </span>
<span>      height <span class="op">=</span> <span class="op">(</span><span class="va">g2broad</span><span class="op">[</span><span class="va">b_text</span><span class="op">]</span> <span class="op">*</span> <span class="va">broad2indicator</span><span class="op">[[</span><span class="va">b_text</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">r_broad</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_rectangle.html">ob_rectangle</a></span><span class="op">(</span></span>
<span>      north <span class="op">=</span> <span class="va">r_g</span><span class="op">@</span><span class="va">south</span>, </span>
<span>      fill <span class="op">=</span> <span class="va">my_fills</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>      width <span class="op">=</span> <span class="fl">1</span>, </span>
<span>      color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      height <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">broad_variance</span><span class="op">[</span><span class="va">b_text</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">broad2indicator</span><span class="op">[[</span><span class="va">b_text</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">error_variance</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">broad2indicator</span><span class="op">[[</span><span class="va">b_text</span><span class="op">]</span><span class="op">]</span> <span class="op">^</span> <span class="fl">2</span></span>
<span>    </span>
<span>    <span class="va">error_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/class_color.html">class_color</a></span><span class="op">(</span><span class="va">my_fills</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span><span class="op">@</span><span class="va">color</span></span>
<span>    </span>
<span>    <span class="va">r_unique</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_rectangle.html">ob_rectangle</a></span><span class="op">(</span></span>
<span>      north <span class="op">=</span> <span class="va">r_broad</span><span class="op">@</span><span class="va">south</span>, </span>
<span>      fill <span class="op">=</span> <span class="va">error_color</span>,</span>
<span>      width <span class="op">=</span> <span class="fl">1</span>, </span>
<span>      color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      height <span class="op">=</span> <span class="va">error_variance</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">error_variance</span> <span class="op">/</span> <span class="va">pi</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span><span class="va">r_unique</span><span class="op">@</span><span class="va">south</span> <span class="op">-</span> <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">r</span> <span class="op">+</span> <span class="fl">.45</span><span class="op">)</span>, radius <span class="op">=</span> <span class="va">r</span>, color <span class="op">=</span> <span class="cn">NA</span>, fill <span class="op">=</span> <span class="va">error_color</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">error2observed</span> <span class="op">&lt;-</span> <span class="fu">direct</span><span class="op">(</span><span class="va">error</span>, <span class="va">r_unique</span>, resect <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="va">error_color</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">r_g</span>, </span>
<span>         <span class="va">r_broad</span>, </span>
<span>         <span class="va">r_unique</span>, </span>
<span>         <span class="va">b_p</span>, </span>
<span>         <span class="va">l_b_p</span>, </span>
<span>         <span class="va">error</span>, </span>
<span>         <span class="va">error2observed</span>, </span>
<span>         <span class="va">lb_o</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">as.geom</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-wedge" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-wedge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causalpaths_files/figure-html/fig-wedge-1.svg" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wedge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 10: Latent variable path diagram with all variables scaled to their variance sizes. Pie wedges and stacked bars display variance proportions of source variables of the same color.
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-hierarchy" class="quarto-xref">Figure 11</a> is a demonstration of how ggdiagram can be used to creating complex models with an eye to aesthetics.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_serif_font</span> <span class="op">&lt;-</span> <span class="st">"Equity Text A"</span></span>
<span><span class="va">str_narrow</span> <span class="op">&lt;-</span> <span class="st">"Narrow Abilities"</span></span>
<span><span class="va">str_tests</span> <span class="op">&lt;-</span> <span class="st">"Tests"</span></span>
<span><span class="va">str_specifics</span> <span class="op">&lt;-</span> <span class="st">"Specifics"</span></span>
<span></span>
<span><span class="co"># gradient fills</span></span>
<span><span class="va">black_gradient</span> <span class="op">&lt;-</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/patterns.html" class="external-link">radialGradient</a></span><span class="op">(</span></span>
<span>  colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gray50"</span>, <span class="st">"gray2"</span>, <span class="st">"gray2"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  stops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.35</span>, <span class="fl">1</span><span class="op">)</span>, group <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">black_gradient_rev</span> <span class="op">&lt;-</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/patterns.html" class="external-link">radialGradient</a></span><span class="op">(</span></span>
<span>  colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gray50"</span>, <span class="st">"black"</span><span class="op">)</span>, group <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span>font_family <span class="op">=</span> <span class="va">my_serif_font</span>, font_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span></span>
<span>      radius <span class="op">=</span> <span class="fl">1.33</span>,</span>
<span>      fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      color <span class="op">=</span> <span class="cn">NA</span></span>
<span>    <span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, </span>
<span>    data <span class="op">=</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span>radius <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">@</span><span class="va">polygon</span>, </span>
<span>    color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">black_gradient</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, </span>
<span>    data <span class="op">=</span> <span class="va">g</span><span class="op">@</span><span class="va">polygon</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>    fill <span class="op">=</span> <span class="va">black_gradient_rev</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">broad_angle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_angle.html">turn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">9</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">16</span><span class="op">)</span> </span>
<span>   <span class="va">broad_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/hcl.html" class="external-link">hcl</a></span><span class="op">(</span></span>
<span>     h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">360</span> <span class="op">-</span> <span class="fl">360</span> <span class="op">/</span> <span class="fl">8</span>, <span class="fl">360</span> <span class="op">/</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span> <span class="fl">20</span>, </span>
<span>     c <span class="op">=</span> <span class="fl">55</span>, </span>
<span>     l <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span>
<span>    <span class="va">broad</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span></span>
<span>      color <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>      fill <span class="op">=</span> <span class="va">broad_color</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span></span>
<span>        from <span class="op">=</span> <span class="va">g</span>, </span>
<span>        where <span class="op">=</span> <span class="va">broad_angle</span>, </span>
<span>        sep <span class="op">=</span> <span class="fl">1.15</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>        <span class="st">"*g*"</span>,</span>
<span>        color <span class="op">=</span> <span class="st">"gray90"</span>,</span>
<span>        fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>        size <span class="op">=</span> <span class="fl">60</span>,</span>
<span>        vjust <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>        family <span class="op">=</span> <span class="va">my_serif_font</span></span>
<span>      <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">broad</span>, </span>
<span>          color <span class="op">=</span> <span class="va">broad_color</span>, </span>
<span>          resect <span class="op">=</span> <span class="fl">1</span>, </span>
<span>          linewidth <span class="op">=</span> <span class="fl">.75</span>, </span>
<span>          length_head <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fu"><a href="../reference/unbind.html">unbind</a></span><span class="op">(</span><span class="va">broad</span><span class="op">)</span>, \<span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">b</span><span class="op">@</span><span class="va">polygon</span>, </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, </span>
<span>      fill <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/patterns.html" class="external-link">radialGradient</a></span><span class="op">(</span></span>
<span>        colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">tinter</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinter/man/lighten.html" class="external-link">lighten</a></span><span class="op">(</span><span class="va">b</span><span class="op">@</span><span class="va">fill</span>, <span class="fl">.4</span><span class="op">)</span>, </span>
<span>                    <span class="fu">tinter</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinter/man/lighten.html" class="external-link">lighten</a></span><span class="op">(</span><span class="va">b</span><span class="op">@</span><span class="va">fill</span>, <span class="fl">.8</span><span class="op">)</span><span class="op">)</span>, </span>
<span>        stops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>        group <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ga"</span>, <span class="st">"Gc"</span>, <span class="st">"Gf"</span>, <span class="st">"Gv"</span>, <span class="st">"Gs"</span>, <span class="st">"Gr"</span>, <span class="st">"Gl"</span>, <span class="st">"Gwm"</span><span class="op">)</span>,</span>
<span>    <span class="va">broad</span><span class="op">@</span><span class="va">center</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_point.html">ob_point</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">.05</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    family <span class="op">=</span> <span class="va">my_serif_font</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    vjust <span class="op">=</span> <span class="fl">.55</span>,</span>
<span>    angle <span class="op">=</span> <span class="va">broad</span><span class="op">@</span><span class="va">center</span><span class="op">@</span><span class="va">theta</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="op">-</span><span class="fl">90</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">broad</span><span class="op">@</span><span class="va">center</span><span class="op">@</span><span class="va">theta</span><span class="op">@</span><span class="va">turn</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"gray20"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_path.html">ob_path</a></span><span class="op">(</span></span>
<span>    <span class="va">broad</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://rconsortium.github.io/S7/reference/props.html" class="external-link">set_props</a></span><span class="op">(</span>radius <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.66</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.59</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="../reference/unbind.html">unbind</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">x</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">center</span><span class="op">@</span><span class="va">theta</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">90</span>, <span class="fl">90</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"gray20"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Auditory"</span>, </span>
<span>        <span class="st">"Knowledge"</span>, </span>
<span>        <span class="st">"Fluid"</span>, </span>
<span>        <span class="st">"Visual-Spatial"</span>, </span>
<span>        <span class="st">"Speed"</span>, </span>
<span>        <span class="st">"Fluency"</span>, </span>
<span>        <span class="st">"Efficiency"</span>, </span>
<span>        <span class="st">"Memory"</span><span class="op">)</span>,</span>
<span>      fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      family <span class="op">=</span> <span class="va">my_serif_font</span>,</span>
<span>      vjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">9.5</span>,</span>
<span>      spacing <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_path.html">ob_path</a></span><span class="op">(</span></span>
<span>    <span class="va">broad</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://rconsortium.github.io/S7/reference/props.html" class="external-link">set_props</a></span><span class="op">(</span>radius <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.59</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.66</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="../reference/unbind.html">unbind</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">x</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span></span>
<span>          <span class="va">x</span><span class="op">@</span><span class="va">center</span><span class="op">@</span><span class="va">theta</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">90</span>, <span class="fl">90</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Processing"</span>, </span>
<span>        <span class="st">"Comprehension"</span>, </span>
<span>        <span class="st">"Reasoning"</span>, </span>
<span>        <span class="st">"Processing"</span>, </span>
<span>        <span class="st">"Processing"</span>, </span>
<span>        <span class="st">"Retrieval"</span>, </span>
<span>        <span class="st">"Learning"</span>, </span>
<span>        <span class="st">"Working"</span><span class="op">)</span>,</span>
<span>            fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>            family <span class="op">=</span> <span class="va">my_serif_font</span>,</span>
<span>            vjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">9.5</span>,</span>
<span>            spacing <span class="op">=</span> <span class="fl">100</span></span>
<span>          <span class="op">)</span>,</span>
<span>          color <span class="op">=</span> <span class="st">"gray20"</span>,</span>
<span>          alpha <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">narrow</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span></span>
<span>    radius <span class="op">=</span> <span class="fl">.45</span>, </span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">broad</span><span class="op">@</span><span class="va">fill</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">g</span>, </span>
<span>          where <span class="op">=</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">360</span> <span class="op">-</span> <span class="fl">360</span><span class="op">/</span><span class="fl">40</span>, <span class="fl">360</span><span class="op">/</span><span class="fl">40</span><span class="op">)</span> <span class="op">+</span> <span class="fl">360</span><span class="op">/</span><span class="fl">80</span><span class="op">)</span>, </span>
<span>          sep <span class="op">=</span> <span class="fl">4.3</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,</span>
<span>          y <span class="op">=</span> <span class="va">y</span>, </span>
<span>          group <span class="op">=</span> <span class="va">group</span>, </span>
<span>          fill <span class="op">=</span> <span class="va">fill</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="va">narrow</span><span class="op">@</span><span class="va">polygon</span>,</span>
<span>      color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/imap.html" class="external-link">imap</a></span><span class="op">(</span><span class="fu"><a href="../reference/unbind.html">unbind</a></span><span class="op">(</span><span class="va">broad</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span>, <span class="va">idx</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">narrow</span><span class="op">[</span><span class="op">(</span><span class="va">idx</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, </span>
<span>            color <span class="op">=</span> <span class="fu">tinter</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinter/man/lighten.html" class="external-link">lighten</a></span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">fill</span>, <span class="fl">.5</span><span class="op">)</span>, </span>
<span>            linewidth <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>            length_head <span class="op">=</span> <span class="fl">6</span>,</span>
<span>            resect <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="../reference/as.geom.html">as.geom</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">test_theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">360</span> <span class="op">-</span> <span class="fl">360</span><span class="op">/</span><span class="fl">120</span>, <span class="fl">360</span><span class="op">/</span><span class="fl">120</span><span class="op">)</span> <span class="op">+</span> <span class="fl">360</span><span class="op">/</span><span class="fl">240</span><span class="op">)</span></span>
<span>    <span class="va">tests</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_ellipse.html">ob_ellipse</a></span><span class="op">(</span></span>
<span>      a <span class="op">=</span> <span class="fl">.18</span>,    </span>
<span>      m1 <span class="op">=</span> <span class="fl">8</span>,</span>
<span>      angle <span class="op">=</span> <span class="va">test_theta</span>,</span>
<span>      color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu">tinter</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinter/man/lighten.html" class="external-link">lighten</a></span><span class="op">(</span><span class="va">broad</span><span class="op">@</span><span class="va">fill</span>, <span class="fl">.2</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">g</span>, where <span class="op">=</span> <span class="va">test_theta</span>, sep <span class="op">=</span> <span class="fl">6.2</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">specifics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span></span>
<span>    radius <span class="op">=</span> <span class="fl">.2</span>, </span>
<span>    angle <span class="op">=</span> <span class="va">test_theta</span>, </span>
<span>    color <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu">tinter</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinter/man/lighten.html" class="external-link">lighten</a></span><span class="op">(</span><span class="va">broad</span><span class="op">@</span><span class="va">fill</span>, <span class="fl">.15</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">g</span>, where <span class="op">=</span> <span class="va">test_theta</span>, sep <span class="op">=</span> <span class="fl">7.0</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">specifics</span>, <span class="va">tests</span>, </span>
<span>          color <span class="op">=</span> <span class="va">specifics</span><span class="op">@</span><span class="va">fill</span>, </span>
<span>          linewidth <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>          length_head <span class="op">=</span> <span class="fl">6</span>, </span>
<span>          resect <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/imap.html" class="external-link">imap</a></span><span class="op">(</span><span class="fu"><a href="../reference/unbind.html">unbind</a></span><span class="op">(</span><span class="va">narrow</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span>, <span class="va">idx</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">tests</span><span class="op">[</span><span class="op">(</span><span class="va">idx</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">3</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, </span>
<span>            color <span class="op">=</span> <span class="fu">tinter</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinter/man/lighten.html" class="external-link">lighten</a></span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">fill</span>, <span class="fl">.5</span><span class="op">)</span>, </span>
<span>            resect <span class="op">=</span> <span class="fl">1</span>, </span>
<span>            linewidth <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>            length_head <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="../reference/as.geom.html">as.geom</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">broad</span><span class="op">@</span><span class="va">fill</span>, </span>
<span>                 \<span class="op">(</span><span class="va">fill</span><span class="op">)</span> <span class="op">{</span> </span>
<span>                   <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/patterns.html" class="external-link">radialGradient</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">tinter</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinter/man/lighten.html" class="external-link">lighten</a></span><span class="op">(</span><span class="va">fill</span>, <span class="fl">.15</span><span class="op">)</span>, </span>
<span>                                          <span class="fu">tinter</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinter/man/lighten.html" class="external-link">lighten</a></span><span class="op">(</span><span class="va">fill</span>, <span class="fl">.4</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                                        stops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                                        group <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">`names&lt;-`</span><span class="op">(</span><span class="va">broad</span><span class="op">@</span><span class="va">fill</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">str_narrow</span>, split <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    center <span class="op">=</span> <span class="va">narrow</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">str_narrow</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">]</span><span class="op">@</span><span class="va">center</span>,</span>
<span>    angle <span class="op">=</span> <span class="va">narrow</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">str_narrow</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">]</span><span class="op">@</span><span class="va">center</span><span class="op">@</span><span class="va">theta</span> <span class="op">-</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    family <span class="op">=</span> <span class="va">my_serif_font</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">16</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"gray30"</span>,</span>
<span>    vjust <span class="op">=</span> <span class="fl">.55</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">str_narrow</span>, split <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    center <span class="op">=</span> <span class="va">narrow</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">str_narrow</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">22</span><span class="op">]</span><span class="op">@</span><span class="va">center</span>,</span>
<span>    angle <span class="op">=</span> <span class="va">narrow</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">str_narrow</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">22</span><span class="op">]</span><span class="op">@</span><span class="va">center</span><span class="op">@</span><span class="va">theta</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    family <span class="op">=</span> <span class="va">my_serif_font</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">16</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"gray30"</span>,</span>
<span>    vjust <span class="op">=</span> <span class="fl">.55</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fl">65</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span>, <span class="fl">30</span>, <span class="fl">45</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">str_tests</span>, split <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      center <span class="op">=</span> <span class="va">tests</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">str_tests</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">x</span><span class="op">]</span><span class="op">@</span><span class="va">center</span>,</span>
<span>      angle <span class="op">=</span> <span class="va">tests</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">str_tests</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">x</span><span class="op">]</span><span class="op">@</span><span class="va">center</span><span class="op">@</span><span class="va">theta</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>,</span>
<span>      fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      family <span class="op">=</span> <span class="va">my_serif_font</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"gray30"</span>,</span>
<span>      vjust <span class="op">=</span> <span class="fl">.57</span></span>
<span>    <span class="op">)</span><span class="op">@</span><span class="va">geom</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fl">5</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span>, <span class="fl">30</span>, <span class="fl">45</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">str_tests</span>, split <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      center <span class="op">=</span> <span class="va">tests</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">str_tests</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">x</span><span class="op">]</span><span class="op">@</span><span class="va">center</span>,</span>
<span>      angle <span class="op">=</span> <span class="va">tests</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">str_tests</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">x</span><span class="op">]</span><span class="op">@</span><span class="va">center</span><span class="op">@</span><span class="va">theta</span> <span class="op">-</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>,</span>
<span>      fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      family <span class="op">=</span> <span class="va">my_serif_font</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"gray30"</span>,</span>
<span>      vjust <span class="op">=</span> <span class="fl">.57</span></span>
<span>    <span class="op">)</span><span class="op">@</span><span class="va">geom</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fl">63</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span>, <span class="fl">30</span>, <span class="fl">45</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">str_specifics</span>, split <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      center <span class="op">=</span> <span class="va">specifics</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">str_specifics</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">x</span><span class="op">]</span><span class="op">@</span><span class="va">center</span>,</span>
<span>      angle <span class="op">=</span> <span class="va">specifics</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">str_specifics</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">x</span><span class="op">]</span><span class="op">@</span><span class="va">center</span><span class="op">@</span><span class="va">theta</span> <span class="op">+</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>,</span>
<span>      fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      family <span class="op">=</span> <span class="va">my_serif_font</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">9</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"gray30"</span>,</span>
<span>      vjust <span class="op">=</span> <span class="fl">.53</span></span>
<span>    <span class="op">)</span><span class="op">@</span><span class="va">geom</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fl">3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span>, <span class="fl">30</span>, <span class="fl">45</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">str_specifics</span>, split <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      center <span class="op">=</span> <span class="va">specifics</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">str_specifics</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">x</span><span class="op">]</span><span class="op">@</span><span class="va">center</span>,</span>
<span>      angle <span class="op">=</span> <span class="va">specifics</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">str_specifics</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">x</span><span class="op">]</span><span class="op">@</span><span class="va">center</span><span class="op">@</span><span class="va">theta</span> <span class="op">-</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>,</span>
<span>      fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      family <span class="op">=</span> <span class="va">my_serif_font</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">9</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"gray30"</span>,</span>
<span>      vjust <span class="op">=</span> <span class="fl">.53</span></span>
<span>    <span class="op">)</span><span class="op">@</span><span class="va">geom</span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-hierarchy" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-hierarchy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causalpaths_files/figure-html/fig-hierarchy-1.svg" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hierarchy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 11: A hierarchical model of cognitive abilities in the Cattell-Horn-Carroll tradition <span class="citation" data-cites="schneiderCattellHornCarrollTheoryCognitive2018">(<a href="#ref-schneiderCattellHornCarrollTheoryCognitive2018" role="doc-biblioref">Schneider &amp; McGrew, 2018</a>)</span>
</figcaption></figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="path-diagrams-for-multilevel-models">Path Diagrams for Multilevel Models<a class="anchor" aria-label="anchor" href="#path-diagrams-for-multilevel-models"></a>
</h3>
<p>The independence assumption of multiple regression requires that the regression errors are independent of each other. When data are clustered in some way that violates this assumption, a multilevel model can account for the within-cluster similarity of data (i.e., the intraclass correlation). Most multilevel models are displayed with equations like these:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Level 1</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>β</mi><mrow><mn>0</mn><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><msub><mi>X</mi><mrow><mn>1</mn><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub><msub><mi>X</mi><mrow><mn>2</mn><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>σ</mi><mi>e</mi><mn>2</mn></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mtext mathvariant="normal">var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Level 2</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>β</mi><mrow><mn>0</mn><mi>j</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>γ</mi><mn>00</mn></msub><mo>+</mo><msub><mi>γ</mi><mn>01</mn></msub><msub><mi>W</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mn>0</mn><mi>j</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>β</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>γ</mi><mn>10</mn></msub><mo>+</mo><msub><mi>γ</mi><mn>11</mn></msub><msub><mi>W</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>β</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>γ</mi><mn>20</mn></msub><mo>+</mo><msub><mi>γ</mi><mn>21</mn></msub><msub><mi>W</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mn>2</mn><mi>j</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>𝛕</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mtext mathvariant="normal">cov</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>τ</mi><mn>00</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>τ</mi><mn>01</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>τ</mi><mn>02</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>τ</mi><mn>01</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>τ</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>τ</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>τ</mi><mn>02</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>τ</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>τ</mi><mn>22</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\text{Level 1}\\
Y_{ij}&amp;=\beta_{0j}+\beta_{1j}X_{1ij}+\beta_{2j}X_{2ij}+e_{ij}\\
\sigma_e^2&amp;=\text{var}\left(e\right)\\
\text{Level 2}\\
\beta_{0j} &amp;= \gamma_{00} + \gamma_{01}W_{1j} + u_{0j}\\
\beta_{1j} &amp;= \gamma_{10} + \gamma_{11}W_{1j} + u_{1j}\\
\beta_{2j} &amp;= \gamma_{20} + \gamma_{21}W_{1j} + u_{2j}\\
\mathbf{\tau} &amp;=\text{cov}\left(u\right)\\
&amp;=\begin{bmatrix}
\tau_{00} &amp; \tau_{01} &amp; \tau_{02}\\
\tau_{01} &amp; \tau_{11} &amp; \tau_{12}\\
\tau_{02} &amp; \tau_{12} &amp; \tau_{22}
\end{bmatrix}
\end{aligned}
</annotation></semantics></math></p>
<p>Here we have an outcome (<em>Y</em>), 2 level-1 predictors (<em>X</em><sub>1</sub> and <em>X</em><sub>2</sub>), and 1 level-2 predictor (<em>W</em><sub>1</sub>). The random intercept (<em>β</em><sub>0<em>j</em></sub>) has as fixed component (<em>γ</em><sub>00</sub> + <em>γ</em><sub>01</sub><em>W</em><sub>1<em>j</em></sub>) and a random component (<em>u</em><sub>0<em>j</em></sub>). The random intercept is partly predicted by the level-2 variable, <em>W</em><sub>1<em>j</em></sub>. The random slopes also have fixed and random components, as well as being predicted by the level-2 variable. The <em>τ</em> matrix is variance-covariance matrix of the level-2 random variables <em>u</em> (i.e., <em>u</em><sub>0<em>j</em></sub>, <em>u</em><sub>1<em>j</em></sub>, and <em>u</em><sub>1<em>j</em></sub>).</p>
<p>These equations specify the model unambiguously, but it is easy to lose one’s way in them. It can facilitate interpretation if the equations are presented in a visual mode.</p>
<p><span class="citation" data-cites="curranBuildingPathDiagrams2007">Curran &amp; Bauer (<a href="#ref-curranBuildingPathDiagrams2007" role="doc-biblioref">2007</a>)</span> developed a set of extensions to path diagrams to incorporate random slopes and intercepts from multilevel models. Their core innovation is to treat random slopes and intercepts as latent variables that sit atop direct paths. An example of this approach is in <a href="#fig-multilevel" class="quarto-xref">Figure 12</a>. It displays the same information as the equations listed previously, but in terms that are easier to understand and use.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clr</span> <span class="op">&lt;-</span>   <span class="fu"><a href="../reference/class_color.html">class_color</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#976A85"</span>,</span>
<span>    <span class="st">"#7385A1"</span>,</span>
<span>    <span class="st">"#4E9C9B"</span>,</span>
<span>    <span class="st">"#66AB7A"</span>,</span>
<span>    <span class="st">"#A4AF5A"</span><span class="op">)</span><span class="op">)</span><span class="op">@</span><span class="va">darken</span><span class="op">(</span><span class="fl">.3</span><span class="op">)</span><span class="op">@</span><span class="va">color</span></span>
<span></span>
<span><span class="va">clr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#6B4B5E"</span>, <span class="st">"#515E72"</span>, <span class="st">"#376E6E"</span>, <span class="st">"#487956"</span>, <span class="st">"#747C3F"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">observed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_ellipse</span>, m1 <span class="op">=</span> <span class="fl">10</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">lb_observed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_label</span>, fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"white"</span>, size <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span>
<span><span class="va">lb_slope</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_label</span>, fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"white"</span>, size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span>
<span></span>
<span><span class="va">random_slope</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_circle</span>, color <span class="op">=</span> <span class="cn">NA</span>, radius <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span><span class="va">tau_covariance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_covariance</span>, </span>
<span>                            linewidth <span class="op">=</span> <span class="fl">.5</span>, </span>
<span>                            head_length <span class="op">=</span> <span class="fl">4</span>, </span>
<span>                            resect <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">latent_slope_line</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_line.html">ob_line</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="op">-</span><span class="fl">.8</span>, intercept <span class="op">=</span> <span class="fl">1.3</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span>font_family <span class="op">=</span> <span class="va">my_font</span>, font_size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="va">i1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_intercept.html">ob_intercept</a></span><span class="op">(</span></span>
<span>    width <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="st">"1~1~"</span>, </span>
<span>      color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>      fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">24</span><span class="op">)</span>,</span>
<span>    vertex_radius <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">.6</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clr</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu">observed</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">lb_observed</span><span class="op">(</span><span class="st">"*X*~1*ij*~"</span><span class="op">)</span>, </span>
<span>                  fill <span class="op">=</span> <span class="va">clr</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="../reference/bind.html">bind</a></span><span class="op">(</span><span class="va">i1</span><span class="op">@</span><span class="va">segment</span><span class="op">)</span><span class="op">@</span><span class="va">midpoint</span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>          where <span class="op">=</span> <span class="st">"below"</span>, </span>
<span>          sep <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu">observed</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">lb_observed</span><span class="op">(</span><span class="st">"*X*~2*ij*~"</span><span class="op">)</span>,</span>
<span>                  fill <span class="op">=</span> <span class="va">clr</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">x1</span>, </span>
<span>          where <span class="op">=</span> <span class="st">"below"</span>, </span>
<span>          sep <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">observed</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">lb_observed</span><span class="op">(</span><span class="st">"*Y*~*ij*~"</span><span class="op">)</span>,</span>
<span>                fill <span class="op">=</span> <span class="va">clr</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">x1</span>, </span>
<span>          where <span class="op">=</span> <span class="st">"right"</span>, </span>
<span>          sep <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="va">i1_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">i1</span>, <span class="va">y</span>, resect <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="va">clr</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="va">x1_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">y</span>, resect <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="va">clr</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="va">x2_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">x2</span>, <span class="va">y</span>, resect <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="va">clr</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">latent_slope_line</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_line.html">ob_line</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="op">-</span><span class="fl">.8</span>, intercept <span class="op">=</span> <span class="fl">1.3</span><span class="op">)</span></span>
<span>  <span class="va">b0j</span> <span class="op">&lt;-</span> <span class="fu">random_slope</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/intersection.html">intersection</a></span><span class="op">(</span><span class="va">latent_slope_line</span>, <span class="va">i1_y</span><span class="op">@</span><span class="va">line</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clr</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    label <span class="op">=</span> <span class="fu">lb_slope</span><span class="op">(</span><span class="st">"*&amp;beta;*~0*j*~"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">b1j</span> <span class="op">&lt;-</span> <span class="fu">random_slope</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/intersection.html">intersection</a></span><span class="op">(</span><span class="va">latent_slope_line</span>, <span class="va">x1_y</span><span class="op">@</span><span class="va">line</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clr</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    label <span class="op">=</span> <span class="fu">lb_slope</span><span class="op">(</span><span class="st">"*&amp;beta;*~1*j*~"</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">b2j</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/intersection.html">intersection</a></span><span class="op">(</span><span class="va">latent_slope_line</span>, <span class="va">x2_y</span><span class="op">@</span><span class="va">line</span><span class="op">)</span>,</span>
<span>    radius <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clr</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    label <span class="op">=</span> <span class="fu">lb_slope</span><span class="op">(</span><span class="st">"*&amp;beta;*~2*j*~"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">i2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_intercept.html">ob_intercept</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    <span class="fu"><a href="../reference/rotate.html">rotate</a></span><span class="op">(</span><span class="va">latent_slope_line</span>, <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">90</span><span class="op">)</span>, origin <span class="op">=</span> <span class="va">b0j</span><span class="op">@</span><span class="va">center</span><span class="op">)</span><span class="op">@</span><span class="va">point_at_x</span><span class="op">(</span><span class="va">b1j</span><span class="op">@</span><span class="va">center</span><span class="op">@</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    label <span class="op">=</span> <span class="fu">lb_observed</span><span class="op">(</span><span class="st">"1~2~"</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clr</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>    vertex_radius <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">.6</span>, <span class="st">"mm"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">w1</span> <span class="op">&lt;-</span> <span class="fu">observed</span><span class="op">(</span></span>
<span>    center <span class="op">=</span> <span class="va">i2</span><span class="op">@</span><span class="va">center</span> <span class="op"><a href="../reference/perpendicular_point.html">%-|%</a></span> <span class="va">y</span><span class="op">@</span><span class="va">center</span>,</span>
<span>    label <span class="op">=</span> <span class="fu">lb_observed</span><span class="op">(</span><span class="st">"*W*~1*j*~"</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clr</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span></span>
<span>  <span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind.html">bind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">b0j</span>, <span class="va">b1j</span>, <span class="va">b2j</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">i2b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span></span>
<span>     <span class="va">i2</span>,</span>
<span>     <span class="va">b</span>,</span>
<span>     color <span class="op">=</span> <span class="va">i2</span><span class="op">@</span><span class="va">fill</span>,</span>
<span>     resect <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"*&amp;gamma;*~"</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, <span class="st">"0~"</span><span class="op">)</span>,</span>
<span>       angle <span class="op">=</span> <span class="fl">0</span>,</span>
<span>       size <span class="op">=</span> <span class="fl">16</span></span>
<span>     <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">w1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span></span>
<span>    <span class="va">w1</span>,</span>
<span>    <span class="va">b</span>,</span>
<span>    color <span class="op">=</span> <span class="va">w1</span><span class="op">@</span><span class="va">fill</span>,</span>
<span>    resect <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"*&amp;gamma;*~"</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, <span class="st">"1~"</span><span class="op">)</span>,</span>
<span>      angle <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">16</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span></span>
<span>    radius <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">b</span><span class="op">@</span><span class="va">fill</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"*u*~"</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, <span class="st">"*j*~"</span><span class="op">)</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>      fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">14</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">b</span>, <span class="st">"southwest"</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span></span>
<span>    <span class="va">u</span>,</span>
<span>    <span class="va">b</span>,</span>
<span>    color <span class="op">=</span> <span class="va">b</span><span class="op">@</span><span class="va">fill</span>,</span>
<span>    resect <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    length_head <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tau_covariance</span><span class="op">(</span></span>
<span>    <span class="va">u</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    <span class="va">u</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="../reference/mean_color.html">mean_color</a></span><span class="op">(</span><span class="va">clr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"*&amp;tau;*~01~"</span>, </span>
<span>                     color <span class="op">=</span> <span class="fu"><a href="../reference/mean_color.html">mean_color</a></span><span class="op">(</span><span class="va">clr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tau_covariance</span><span class="op">(</span></span>
<span>    <span class="va">u</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>    <span class="va">u</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="../reference/mean_color.html">mean_color</a></span><span class="op">(</span><span class="va">clr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"*&amp;tau;*~12~"</span>, color <span class="op">=</span> <span class="fu"><a href="../reference/mean_color.html">mean_color</a></span><span class="op">(</span><span class="va">clr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tau_covariance</span><span class="op">(</span></span>
<span>    <span class="va">u</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fl">210</span><span class="op">)</span>,</span>
<span>    <span class="va">u</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fl">260</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="../reference/mean_color.html">mean_color</a></span><span class="op">(</span><span class="va">clr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"*&amp;tau;*~02~"</span>, color <span class="op">=</span> <span class="fu"><a href="../reference/mean_color.html">mean_color</a></span><span class="op">(</span><span class="va">clr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    bend <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/ob_variance.html">ob_variance</a></span><span class="op">(</span></span>
<span>    <span class="va">u</span>,</span>
<span>    color <span class="op">=</span> <span class="va">u</span><span class="op">@</span><span class="va">fill</span>,</span>
<span>    <span class="st">"east"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>    looseness <span class="op">=</span> <span class="fl">1.9</span>,</span>
<span>    bend <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    arrowhead_length <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    resect <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"*&amp;tau;*~"</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, <span class="st">"~"</span><span class="op">)</span>,</span>
<span>      label.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      label.padding <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      color <span class="op">=</span> <span class="va">b</span><span class="op">@</span><span class="va">fill</span></span>
<span>    <span class="op">)</span>,</span>
<span>    theta <span class="op">=</span> <span class="fl">60</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_circle.html">ob_circle</a></span><span class="op">(</span>radius <span class="op">=</span> <span class="fl">.6</span>, fill <span class="op">=</span> <span class="va">y</span><span class="op">@</span><span class="va">fill</span>, color <span class="op">=</span> <span class="cn">NA</span>, label <span class="op">=</span> <span class="fu">lb_observed</span><span class="op">(</span><span class="st">"*e~ij~*"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">y</span>, <span class="st">"right"</span>, <span class="fl">.9</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="va">e</span>, <span class="va">y</span>, color <span class="op">=</span> <span class="va">y</span><span class="op">@</span><span class="va">fill</span>, resect <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">e_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_variance.html">ob_variance</a></span><span class="op">(</span><span class="va">e</span>, <span class="st">"east"</span>, color <span class="op">=</span> <span class="va">e</span><span class="op">@</span><span class="va">fill</span>, looseness <span class="op">=</span> <span class="fl">1.7</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_latex.html">ob_latex</a></span><span class="op">(</span><span class="st">r"(\text{\emph{σ}}^{\text{2}}_{\mkern-1.5mu\text{\emph{e}}})"</span>, <span class="va">e_var</span><span class="op">@</span><span class="va">midpoint</span><span class="op">(</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">.45</span>, family <span class="op">=</span> <span class="st">"Roboto Condensed"</span>, filename <span class="op">=</span> <span class="st">"sigma_e_2"</span>, color <span class="op">=</span> <span class="va">e</span><span class="op">@</span><span class="va">fill</span><span class="op">)</span></span>
<span>  </span>
<span>  </span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-multilevel" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-multilevel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causalpaths_files/figure-html/fig-multilevel-1.svg" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-multilevel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 12: A path diagram for a multilevel model
</figcaption></figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="path-models-for-bivariate-latent-growth-models">Path Models for Bivariate Latent Growth Models<a class="anchor" aria-label="anchor" href="#path-models-for-bivariate-latent-growth-models"></a>
</h3>
<p>Bivariate latent growth models are used to model the change in two variables over time. The latent intercepts <em>i<sub>X</sub></em> and <em>i<sub>Y</sub></em> represent the initial status of the two variables, while the latent slopes <em>s<sub>X</sub></em> and <em>s<sub>Y</sub></em> represent the linear growth rate. The model also includes structured residuals that allow for the separation of between-person change and within-person change <span class="citation" data-cites="curranSeparationBetweenpersonWithinperson2014">Curran et al. (<a href="#ref-curranSeparationBetweenpersonWithinperson2014" role="doc-biblioref">2014</a>)</span>. The <em>b<sub>XX</sub></em> and <em>b<sub>YY</sub></em> autocorrelation parameters measures within-person stability, and the <em>b<sub>XY</sub></em> and <em>b<sub>YX</sub></em> cross-lag parameters measures within-person bidirectional influence.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">color_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/class_color.html">class_color</a></span><span class="op">(</span><span class="va">my_fills</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">color_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/class_color.html">class_color</a></span><span class="op">(</span><span class="va">my_fills</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">color_xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/class_color.html">class_color</a></span><span class="op">(</span><span class="va">my_fills</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">my_observed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_ellipse</span>,</span>
<span>                         m1 <span class="op">=</span> <span class="fl">15</span>,</span>
<span>                         fill <span class="op">=</span> <span class="va">color_x</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.85</span><span class="op">)</span>,</span>
<span>                         color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_latent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_circle</span>,</span>
<span>                       radius <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">4</span> <span class="op">/</span> <span class="va">pi</span><span class="op">)</span>,</span>
<span>                         fill <span class="op">=</span> <span class="va">color_x</span>,</span>
<span>                         color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_label</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span></span>
<span>  <span class="va">ob_label</span>,</span>
<span>  color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  family <span class="op">=</span> <span class="va">my_font</span>,</span>
<span>  nudge_y <span class="op">=</span> <span class="op">-</span><span class="fl">.05</span></span>
<span><span class="op">)</span></span>
<span><span class="va">my_connect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">connect</span>, </span>
<span>                        resect <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                        color <span class="op">=</span> <span class="va">color_x</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.85</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">my_connect2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">connect</span>,</span>
<span>                         length_head <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                         resect <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                         color <span class="op">=</span> <span class="va">color_x</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.70</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">my_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redefault.html">redefault</a></span><span class="op">(</span><span class="va">ob_circle</span>,</span>
<span>                      radius <span class="op">=</span> <span class="fl">.35</span>,</span>
<span>                      fill <span class="op">=</span> <span class="va">color_x</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.7</span><span class="op">)</span>,</span>
<span>                      color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">my_font</span> <span class="op">&lt;-</span> <span class="st">"Roboto Condensed"</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">my_sep</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span>
<span><span class="va">e_sep</span> <span class="op">&lt;-</span> <span class="fl">.7</span></span>
<span><span class="va">l_dist</span> <span class="op">&lt;-</span> <span class="fl">.53</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdiagram.html">ggdiagram</a></span><span class="op">(</span>font_family <span class="op">=</span> <span class="va">my_font</span>, font_size <span class="op">=</span> <span class="fl">24</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">my_observed</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/ob_array.html">ob_array</a></span><span class="op">(</span><span class="va">k</span>,</span>
<span>             sep <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>             where <span class="op">=</span> <span class="st">"south"</span>,</span>
<span>             label <span class="op">=</span> <span class="fu">my_label</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"*X*~"</span> , <span class="fl">1</span><span class="op">:</span><span class="va">k</span>, <span class="st">"~"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">my_observed</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">my_label</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"*Y*~"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">k</span>, <span class="st">"~"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                    fill <span class="op">=</span> <span class="va">color_y</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.85</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"right"</span>, sep <span class="op">=</span> <span class="fl">7</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">e_x</span> <span class="op">&lt;-</span> <span class="fu">my_error</span><span class="op">(</span>radius <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"right"</span>, sep <span class="op">=</span> <span class="va">e_sep</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">e_y</span> <span class="op">&lt;-</span> <span class="fu">my_error</span><span class="op">(</span>radius <span class="op">=</span> <span class="fl">.5</span>, </span>
<span>                   fill <span class="op">=</span> <span class="va">color_y</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.70</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">y</span>, <span class="st">"left"</span>, sep <span class="op">=</span> <span class="va">e_sep</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">ee_x</span> <span class="op">&lt;-</span> <span class="fu">my_error</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">color_x</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.55</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">e_x</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"right"</span>, sep <span class="op">=</span> <span class="va">e_sep</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">ee_y</span> <span class="op">&lt;-</span> <span class="fu">my_error</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">color_y</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.55</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">e_y</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"left"</span>, sep <span class="op">=</span> <span class="va">e_sep</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">lxx</span> <span class="op">&lt;-</span> <span class="fu">my_connect</span><span class="op">(</span><span class="va">e_x</span><span class="op">[</span><span class="op">-</span><span class="va">k</span><span class="op">]</span>, <span class="va">e_x</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, color <span class="op">=</span> <span class="va">color_x</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.70</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"*b~XX~*"</span>, <span class="va">lxx</span><span class="op">@</span><span class="va">midpoint</span><span class="op">(</span><span class="fl">.47</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">lxy</span> <span class="op">&lt;-</span> <span class="fu">my_connect</span><span class="op">(</span><span class="va">e_x</span><span class="op">[</span><span class="op">-</span><span class="va">k</span><span class="op">]</span>, <span class="va">e_y</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, color <span class="op">=</span> <span class="va">color_x</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.70</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"*b~XY~*"</span>, <span class="va">lxy</span><span class="op">@</span><span class="va">midpoint</span><span class="op">(</span><span class="fl">.27</span>, color <span class="op">=</span> <span class="va">color_x</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.70</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">lyx</span> <span class="op">&lt;-</span> <span class="fu">my_connect</span><span class="op">(</span><span class="va">e_y</span><span class="op">[</span><span class="op">-</span><span class="va">k</span><span class="op">]</span>, <span class="va">e_x</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, color <span class="op">=</span> <span class="va">color_y</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"*b~YX~*"</span>, <span class="va">lyx</span><span class="op">@</span><span class="va">midpoint</span><span class="op">(</span><span class="fl">.27</span>, color <span class="op">=</span> <span class="va">color_y</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.70</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">lyy</span> <span class="op">&lt;-</span> <span class="fu">my_connect</span><span class="op">(</span><span class="va">e_y</span><span class="op">[</span><span class="op">-</span><span class="va">k</span><span class="op">]</span>, <span class="va">e_y</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, color <span class="op">=</span> <span class="va">color_y</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.70</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"*b~YY~*"</span>, <span class="va">lyy</span><span class="op">@</span><span class="va">midpoint</span><span class="op">(</span><span class="fl">.47</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">my_connect2</span><span class="op">(</span><span class="va">e_x</span>, <span class="va">x</span>, color <span class="op">=</span> <span class="va">color_x</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.70</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">my_connect2</span><span class="op">(</span><span class="va">e_y</span>, <span class="va">y</span>, color <span class="op">=</span> <span class="va">color_y</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.70</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">my_connect2</span><span class="op">(</span><span class="va">ee_x</span>, <span class="va">e_x</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, color <span class="op">=</span> <span class="va">color_x</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.55</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">my_connect2</span><span class="op">(</span><span class="va">ee_y</span>, <span class="va">e_y</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, color <span class="op">=</span> <span class="va">color_y</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.55</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_covariance.html">ob_covariance</a></span><span class="op">(</span><span class="va">e_x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">e_y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, color <span class="op">=</span> <span class="va">color_xy</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.70</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/ob_covariance.html">ob_covariance</a></span><span class="op">(</span><span class="va">ee_y</span>, <span class="va">ee_x</span>, </span>
<span>                resect <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                length_head <span class="op">=</span> <span class="fl">4</span>, </span>
<span>                length_fins <span class="op">=</span> <span class="fl">4</span>, </span>
<span>                looseness <span class="op">=</span> <span class="fl">1.3</span>,</span>
<span>                color <span class="op">=</span> <span class="va">color_xy</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.55</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">ix</span> <span class="op">&lt;-</span> <span class="fu">my_latent</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">my_label</span><span class="op">(</span><span class="st">"*i*~*X*~"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="st">"left"</span><span class="op">)</span>, <span class="st">"left"</span>, </span>
<span>          sep <span class="op">=</span> <span class="va">my_sep</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">iy</span> <span class="op">&lt;-</span> <span class="fu">my_latent</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">my_label</span><span class="op">(</span><span class="st">"*i*~*Y*~"</span><span class="op">)</span>, </span>
<span>                   fill <span class="op">=</span> <span class="va">color_y</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="st">"right"</span><span class="op">)</span>, </span>
<span>          where <span class="op">=</span> <span class="st">"right"</span>, </span>
<span>          sep <span class="op">=</span> <span class="va">my_sep</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="va">sx</span> <span class="op">&lt;-</span> <span class="fu">my_latent</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">my_label</span><span class="op">(</span><span class="st">"*s*~*X*~"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="st">"left"</span><span class="op">)</span>, </span>
<span>          where <span class="op">=</span> <span class="st">"left"</span>, </span>
<span>          sep <span class="op">=</span> <span class="va">my_sep</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">sy</span> <span class="op">&lt;-</span> <span class="fu">my_latent</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">my_label</span><span class="op">(</span><span class="st">"*s*~*Y*~"</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">color_y</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="../reference/place.html">place</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="st">"right"</span><span class="op">)</span>, <span class="st">"right"</span>, sep <span class="op">=</span> <span class="va">my_sep</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="va">lx</span> <span class="op">&lt;-</span> <span class="fu">my_connect</span><span class="op">(</span><span class="va">ix</span>, <span class="va">x</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">175</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">ly</span> <span class="op">&lt;-</span> <span class="fu">my_connect</span><span class="op">(</span><span class="va">iy</span>, <span class="va">y</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">color_y</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.85</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"1"</span>,</span>
<span>           center <span class="op">=</span> <span class="va">lx</span><span class="op">@</span><span class="va">line</span><span class="op">@</span><span class="va">point_at_x</span><span class="op">(</span><span class="va">lx</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">@</span><span class="va">midpoint</span><span class="op">(</span><span class="va">l_dist</span><span class="op">)</span><span class="op">@</span><span class="va">x</span><span class="op">)</span>,</span>
<span>           size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="st">"1"</span>,</span>
<span>           center <span class="op">=</span> <span class="va">ly</span><span class="op">@</span><span class="va">line</span><span class="op">@</span><span class="va">point_at_x</span><span class="op">(</span><span class="va">ly</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">@</span><span class="va">midpoint</span><span class="op">(</span><span class="va">l_dist</span><span class="op">)</span><span class="op">@</span><span class="va">x</span><span class="op">)</span>,</span>
<span>           size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="op">{</span><span class="va">lsx</span> <span class="op">&lt;-</span> <span class="fu">my_connect</span><span class="op">(</span><span class="va">sx</span>, <span class="va">x</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">185</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span></span>
<span>  <span class="op">{</span><span class="va">lsy</span> <span class="op">&lt;-</span> <span class="fu">my_connect</span><span class="op">(</span><span class="va">sy</span>, <span class="va">y</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">color_y</span><span class="op">)</span><span class="op">}</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>           center <span class="op">=</span> <span class="va">lsx</span><span class="op">@</span><span class="va">line</span><span class="op">@</span><span class="va">point_at_x</span><span class="op">(</span><span class="va">lsx</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">@</span><span class="va">midpoint</span><span class="op">(</span><span class="va">l_dist</span><span class="op">)</span><span class="op">@</span><span class="va">x</span><span class="op">)</span>,</span>
<span>           size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_label.html">ob_label</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>           center <span class="op">=</span> <span class="va">lsy</span><span class="op">@</span><span class="va">line</span><span class="op">@</span><span class="va">point_at_x</span><span class="op">(</span><span class="va">lsy</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">@</span><span class="va">midpoint</span><span class="op">(</span><span class="va">l_dist</span><span class="op">)</span><span class="op">@</span><span class="va">x</span><span class="op">)</span>,</span>
<span>           size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_covariance.html">ob_covariance</a></span><span class="op">(</span><span class="va">ix</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">80</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                <span class="va">iy</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                looseness <span class="op">=</span> <span class="fl">1.1</span>, </span>
<span>                bend <span class="op">=</span> <span class="fl">40</span>,</span>
<span>                color <span class="op">=</span> <span class="va">color_xy</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.85</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_covariance.html">ob_covariance</a></span><span class="op">(</span><span class="va">ix</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">95</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                <span class="va">sy</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">55</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                looseness <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>                bend <span class="op">=</span> <span class="fl">60</span>,</span>
<span>                color <span class="op">=</span> <span class="va">color_xy</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.85</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_covariance.html">ob_covariance</a></span><span class="op">(</span><span class="va">sy</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">260</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                <span class="va">sx</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">280</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                looseness <span class="op">=</span> <span class="fl">1.1</span>, </span>
<span>                bend <span class="op">=</span> <span class="fl">40</span>,</span>
<span>                color <span class="op">=</span> <span class="va">color_xy</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.85</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_covariance.html">ob_covariance</a></span><span class="op">(</span><span class="va">sy</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">285</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                <span class="va">ix</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">235</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                looseness <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>                bend <span class="op">=</span> <span class="fl">60</span>,</span>
<span>                color <span class="op">=</span> <span class="va">color_xy</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.85</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_covariance.html">ob_covariance</a></span><span class="op">(</span><span class="va">iy</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="op">-</span><span class="fl">70</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                <span class="va">sy</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">70</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                bend <span class="op">=</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span><span class="op">)</span>,</span>
<span>                color <span class="op">=</span> <span class="va">color_y</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.85</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ob_covariance.html">ob_covariance</a></span><span class="op">(</span><span class="va">sx</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="fl">110</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                <span class="va">ix</span><span class="op">@</span><span class="va">point_at</span><span class="op">(</span><span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="op">-</span><span class="fl">110</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                bend <span class="op">=</span> <span class="fu"><a href="../reference/ob_angle.html">degree</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span><span class="op">)</span>,</span>
<span>                color <span class="op">=</span> <span class="va">color_x</span><span class="op">@</span><span class="va">lighten</span><span class="op">(</span><span class="fl">.85</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div id="fig-bivariate-change" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-bivariate-change-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="causalpaths_files/figure-html/fig-bivariate-change-1.svg" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bivariate-change-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 13: A path diagram for latent growth model with structured residuals
</figcaption></figure>
</div>
</div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-curranBuildingPathDiagrams2007" class="csl-entry" role="listitem">
Curran, P. J., &amp; Bauer, D. J. (2007). Building path diagrams for multilevel models. <em>Psychological Methods</em>, <em>12</em>(3), 283–297. <a href="https://doi.org/10.1037/1082-989X.12.3.283" class="external-link">https://doi.org/10.1037/1082-989X.12.3.283</a>
</div>
<div id="ref-curranSeparationBetweenpersonWithinperson2014" class="csl-entry" role="listitem">
Curran, P. J., Howard, A. L., Bainter, S. A., Lane, S. T., &amp; McGinley, J. S. (2014). The separation of between-person and within-person components of individual change over time: A latent curve model with structured residuals. <em>Journal of Consulting and Clinical Psychology</em>, <em>82</em>(5), 879–894. <a href="https://doi.org/10.1037/a0035297" class="external-link">https://doi.org/10.1037/a0035297</a>
</div>
<div id="ref-schneiderCattellHornCarrollTheoryCognitive2018" class="csl-entry" role="listitem">
Schneider, W. J., &amp; McGrew, K. S. (2018). The Cattell-Horn-Carroll theory of cognitive abilities. In D. P. Flanagan &amp; E. M. McDonough (Eds.), <em>Contemporary intellectual assessment: Theories, tests, and issues</em> (4th ed., pp. 73–130). Guilford Press. <a href="https://www.guilford.com/books/Contemporary-Intellectual-Assessment/Flanagan-McDonough/9781462552030" class="external-link">https://www.guilford.com/books/Contemporary-Intellectual-Assessment/Flanagan-McDonough/9781462552030</a>
</div>
<div id="ref-wrightRelativeImportanceHeredity1920" class="csl-entry" role="listitem">
Wright, S. (1920). The relative importance of heredity and environment in determining the piebald pattern of guinea-pigs. <em>Proceedings of the National Academy of Sciences</em>, <em>6</em>(6), 320–332. <a href="https://doi.org/10.1073/pnas.6.6.320" class="external-link">https://doi.org/10.1073/pnas.6.6.320</a>
</div>
</div>
</section></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by W. Joel Schneider.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
